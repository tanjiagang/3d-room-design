import{c as $n,r as qn,o as Xe,R as Zn,P as xn,V as j,C as Jn,M as Be,T as De,Q as lt,S as Kt,a as B,b as Tn,O as An,d as R,B as Dt,F as Xt,e as ei,f as wt,g as En,L as ti,h as $e,i as Sn,j as T,k as de,l as ni,m as ii,D as Mn,n as Ye,p as Fe,q as pe,I as si,s as oi,t as Cn,u as ri,v as ai,w as Re,x as li,y as et,z as Rn,A as xt,N as Pn,E as ci,G as dt,H as ui,J as K,K as Tt,U as hi,W as di,X as fi,Y as pi,Z as mi,_ as _i,$,a0 as On,a1 as gi,a2 as yi,a3 as bi,a4 as kn,a5 as Yt,a6 as He,a7 as vi,a8 as wi,a9 as xi,aa as Ti,ab as Ai,ac as Ei,ad as Si,ae as Mi,af as Wt,ag as Qt,ah as $t,ai as qt,aj as Ci,ak as Ri,al as Pi,am as Oi,an as ae,ao as ft,ap as it,aq as Ce,ar as Ln,as as we,at as At,au as ki,av as Li,aw as Di,ax as Ii,ay as Ni,az as te,aA as Bi,aB as zi,aC as Dn,aD as It,aE as Fi,aF as Hi,aG as Ui,aH as ji,aI as st,aJ as Gi,aK as Vi,aL as Zt,aM as W,aN as pt,aO as Jt,aP as Ki,aQ as Xi,aR as Yi,aS as Wi,aT as Qi,aU as $i,aV as qi,aW as Zi,aX as en,aY as Ji,aZ as es,a_ as ts,a$ as ns}from"./vendor-CGmEFPla.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const In=(n,e)=>{const t=n.__vccOpts||n;for(const[i,s]of e)t[i]=s;return t},is={};function ss(n,e){const t=qn("RouterView");return Xe(),$n(t)}const os=In(is,[["render",ss]]),tn={type:"change"},Nt={type:"start"},Nn={type:"end"},ot=new Zn,nn=new xn,rs=Math.cos(70*Tn.DEG2RAD),Q=new j,ee=2*Math.PI,L={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},mt=1e-6;class as extends Jn{constructor(e,t=null){super(e,t),this.state=L.NONE,this.enabled=!0,this.target=new j,this.cursor=new j,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Be.ROTATE,MIDDLE:Be.DOLLY,RIGHT:Be.PAN},this.touches={ONE:De.ROTATE,TWO:De.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new j,this._lastQuaternion=new lt,this._lastTargetPosition=new j,this._quat=new lt().setFromUnitVectors(e.up,new j(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Kt,this._sphericalDelta=new Kt,this._scale=1,this._panOffset=new j,this._rotateStart=new B,this._rotateEnd=new B,this._rotateDelta=new B,this._panStart=new B,this._panEnd=new B,this._panDelta=new B,this._dollyStart=new B,this._dollyEnd=new B,this._dollyDelta=new B,this._dollyDirection=new j,this._mouse=new B,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=cs.bind(this),this._onPointerDown=ls.bind(this),this._onPointerUp=us.bind(this),this._onContextMenu=gs.bind(this),this._onMouseWheel=fs.bind(this),this._onKeyDown=ps.bind(this),this._onTouchStart=ms.bind(this),this._onTouchMove=_s.bind(this),this._onMouseDown=hs.bind(this),this._onMouseMove=ds.bind(this),this._interceptControlDown=ys.bind(this),this._interceptControlUp=bs.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(tn),this.update(),this.state=L.NONE}update(e=null){const t=this.object.position;Q.copy(t).sub(this.target),Q.applyQuaternion(this._quat),this._spherical.setFromVector3(Q),this.autoRotate&&this.state===L.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(i)&&isFinite(s)&&(i<-Math.PI?i+=ee:i>Math.PI&&(i-=ee),s<-Math.PI?s+=ee:s>Math.PI&&(s-=ee),i<=s?this._spherical.theta=Math.max(i,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+s)/2?Math.max(i,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=r!=this._spherical.radius}if(Q.setFromSpherical(this._spherical),Q.applyQuaternion(this._quatInverse),t.copy(this.target).add(Q),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const a=Q.length();r=this._clampDistance(a*this._scale);const l=a-r;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),o=!!l}else if(this.object.isOrthographicCamera){const a=new j(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=l!==this.object.zoom;const u=new j(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),r=Q.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(ot.origin.copy(this.object.position),ot.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ot.direction))<rs?this.object.lookAt(this.target):(nn.setFromNormalAndCoplanarPoint(this.object.up,this.target),ot.intersectPlane(nn,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>mt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>mt||this._lastTargetPosition.distanceToSquared(this.target)>mt?(this.dispatchEvent(tn),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?ee/60*this.autoRotateSpeed*e:ee/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Q.setFromMatrixColumn(t,0),Q.multiplyScalar(-e),this._panOffset.add(Q)}_panUp(e,t){this.screenSpacePanning===!0?Q.setFromMatrixColumn(t,1):(Q.setFromMatrixColumn(t,0),Q.crossVectors(this.object.up,Q)),Q.multiplyScalar(e),this._panOffset.add(Q)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;Q.copy(s).sub(this.target);let o=Q.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/i.clientHeight,this.object.matrix),this._panUp(2*t*o/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),s=e-i.left,o=t-i.top,r=i.width,a=i.height;this._mouse.x=s/r*2-1,this._mouse.y=-(o/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(ee*this._rotateDelta.x/t.clientHeight),this._rotateUp(ee*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(ee*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-ee*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(ee*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-ee*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._rotateStart.set(i,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._panStart.set(i,s)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,s=e.pageY-t.y,o=Math.sqrt(i*i+s*s);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),o=.5*(e.pageY+i.y);this._rotateEnd.set(s,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(ee*this._rotateDelta.x/t.clientHeight),this._rotateUp(ee*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._panEnd.set(i,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,s=e.pageY-t.y,o=Math.sqrt(i*i+s*s);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new B,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function ls(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function cs(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function us(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Nn),this.state=L.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function hs(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Be.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=L.DOLLY;break;case Be.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=L.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=L.ROTATE}break;case Be.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=L.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=L.PAN}break;default:this.state=L.NONE}this.state!==L.NONE&&this.dispatchEvent(Nt)}function ds(n){switch(this.state){case L.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case L.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case L.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function fs(n){this.enabled===!1||this.enableZoom===!1||this.state!==L.NONE||(n.preventDefault(),this.dispatchEvent(Nt),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(Nn))}function ps(n){this.enabled!==!1&&this._handleKeyDown(n)}function ms(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case De.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=L.TOUCH_ROTATE;break;case De.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=L.TOUCH_PAN;break;default:this.state=L.NONE}break;case 2:switch(this.touches.TWO){case De.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=L.TOUCH_DOLLY_PAN;break;case De.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=L.TOUCH_DOLLY_ROTATE;break;default:this.state=L.NONE}break;default:this.state=L.NONE}this.state!==L.NONE&&this.dispatchEvent(Nt)}function _s(n){switch(this._trackPointer(n),this.state){case L.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case L.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case L.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case L.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=L.NONE}}function gs(n){this.enabled!==!1&&n.preventDefault()}function ys(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function bs(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}class nt{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const vs=new An(-1,1,1,-1,0,1);class ws extends Dt{constructor(){super(),this.setAttribute("position",new Xt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Xt([0,2,0,0,2,0],2))}}const xs=new ws;class Bn{constructor(e){this._mesh=new R(xs,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,vs)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}function sn(n,e){if(e===ei)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===wt||e===En){let t=n.getIndex();if(t===null){const r=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)r.push(l);n.setIndex(r),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,s=[];if(e===wt)for(let r=1;r<=i;r++)s.push(t.getX(0)),s.push(t.getX(r)),s.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(s.push(t.getX(r)),s.push(t.getX(r+1)),s.push(t.getX(r+2))):(s.push(t.getX(r+2)),s.push(t.getX(r+1)),s.push(t.getX(r)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class Ts extends ti{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Cs(t)}),this.register(function(t){return new Rs(t)}),this.register(function(t){return new zs(t)}),this.register(function(t){return new Fs(t)}),this.register(function(t){return new Hs(t)}),this.register(function(t){return new Os(t)}),this.register(function(t){return new ks(t)}),this.register(function(t){return new Ls(t)}),this.register(function(t){return new Ds(t)}),this.register(function(t){return new Ms(t)}),this.register(function(t){return new Is(t)}),this.register(function(t){return new Ps(t)}),this.register(function(t){return new Bs(t)}),this.register(function(t){return new Ns(t)}),this.register(function(t){return new Es(t)}),this.register(function(t){return new Us(t)}),this.register(function(t){return new js(t)})}load(e,t,i,s){const o=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const u=$e.extractUrlBase(e);r=$e.resolveURL(u,this.path)}else r=$e.extractUrlBase(e);this.manager.itemStart(e);const a=function(u){s?s(u):console.error(u),o.manager.itemError(e),o.manager.itemEnd(e)},l=new Sn(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{o.parse(u,r,function(h){t(h),o.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){let o;const r={},a={},l=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===zn){try{r[M.KHR_BINARY_GLTF]=new Gs(e)}catch(c){s&&s(c);return}o=JSON.parse(r[M.KHR_BINARY_GLTF].content)}else o=JSON.parse(l.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new no(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const c=this.pluginCallbacks[h](u);c.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[c.name]=c,r[c.name]=!0}if(o.extensionsUsed)for(let h=0;h<o.extensionsUsed.length;++h){const c=o.extensionsUsed[h],d=o.extensionsRequired||[];switch(c){case M.KHR_MATERIALS_UNLIT:r[c]=new Ss;break;case M.KHR_DRACO_MESH_COMPRESSION:r[c]=new Vs(o,this.dracoLoader);break;case M.KHR_TEXTURE_TRANSFORM:r[c]=new Ks;break;case M.KHR_MESH_QUANTIZATION:r[c]=new Xs;break;default:d.indexOf(c)>=0&&a[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}u.setExtensions(r),u.setPlugins(a),u.parse(i,s)}parseAsync(e,t){const i=this;return new Promise(function(s,o){i.parse(e,t,s,o)})}}function As(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const M={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Es{constructor(e){this.parser=e,this.name=M.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let s=t.cache.get(i);if(s)return s;const o=t.json,l=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let u;const h=new T(16777215);l.color!==void 0&&h.setRGB(l.color[0],l.color[1],l.color[2],de);const c=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new Mn(h),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new ii(h),u.distance=c;break;case"spot":u=new ni(h),u.distance=c,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,_e(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),s=Promise.resolve(u),t.cache.add(i,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,o=i.json.nodes[e],a=(o.extensions&&o.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class Ss{constructor(){this.name=M.KHR_MATERIALS_UNLIT}getMaterialType(){return Ye}extendParams(e,t,i){const s=[];e.color=new T(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const r=o.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],de),e.opacity=r[3]}o.baseColorTexture!==void 0&&s.push(i.assignTexture(e,"map",o.baseColorTexture,Fe))}return Promise.all(s)}}class Ms{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}}class Cs{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(o.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new B(a,a)}return Promise.all(o)}}class Rs{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}}class Ps{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(o)}}class Os{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new T(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=s.extensions[this.name];if(r.sheenColorFactor!==void 0){const a=r.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],de)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&o.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,Fe)),r.sheenRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}}class ks{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&o.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(o)}}class Ls{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&o.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new T().setRGB(a[0],a[1],a[2],de),Promise.all(o)}}class Ds{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class Is{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&o.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new T().setRGB(a[0],a[1],a[2],de),r.specularColorTexture!==void 0&&o.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,Fe)),Promise.all(o)}}class Ns{constructor(e){this.parser=e,this.name=M.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&o.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(o)}}class Bs{constructor(e){this.parser=e,this.name=M.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:pe}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],r=s.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&o.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(o)}}class zs{constructor(e){this.parser=e,this.name=M.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const o=s.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,r)}}class Fs{constructor(e){this.parser=e,this.name=M.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],a=s.images[r.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,r.source,l);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Hs{constructor(e){this.parser=e,this.name=M.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;const r=o.extensions[t],a=s.images[r.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,r.source,l);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Us{constructor(e){this.name=M.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(a){const l=s.byteOffset||0,u=s.byteLength||0,h=s.count,c=s.byteStride,d=new Uint8Array(a,l,u);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(h,c,d,s.mode,s.filter).then(function(p){return p.buffer}):r.ready.then(function(){const p=new ArrayBuffer(h*c);return r.decodeGltfBuffer(new Uint8Array(p),h,c,d,s.mode,s.filter),p})})}else return null}}class js{constructor(e){this.name=M.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const s=t.meshes[i.mesh];for(const u of s.primitives)if(u.mode!==oe.TRIANGLES&&u.mode!==oe.TRIANGLE_STRIP&&u.mode!==oe.TRIANGLE_FAN&&u.mode!==void 0)return null;const r=i.extensions[this.name].attributes,a=[],l={};for(const u in r)a.push(this.parser.getDependency("accessor",r[u]).then(h=>(l[u]=h,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const h=u.pop(),c=h.isGroup?h.children:[h],d=u[0].count,p=[];for(const m of c){const y=new He,b=new j,v=new lt,w=new j(1,1,1),A=new si(m.geometry,m.material,d);for(let _=0;_<d;_++)l.TRANSLATION&&b.fromBufferAttribute(l.TRANSLATION,_),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,_),l.SCALE&&w.fromBufferAttribute(l.SCALE,_),A.setMatrixAt(_,y.compose(b,v,w));for(const _ in l)if(_==="_COLOR_0"){const S=l[_];A.instanceColor=new oi(S.array,S.itemSize,S.normalized)}else _!=="TRANSLATION"&&_!=="ROTATION"&&_!=="SCALE"&&m.geometry.setAttribute(_,l[_]);Cn.prototype.copy.call(A,m),this.parser.assignFinalMaterial(A),p.push(A)}return h.isGroup?(h.clear(),h.add(...p),h):p[0]}))}}const zn="glTF",Ge=12,on={JSON:1313821514,BIN:5130562};class Gs{constructor(e){this.name=M.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Ge),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==zn)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-Ge,o=new DataView(e,Ge);let r=0;for(;r<s;){const a=o.getUint32(r,!0);r+=4;const l=o.getUint32(r,!0);if(r+=4,l===on.JSON){const u=new Uint8Array(e,Ge+r,a);this.content=i.decode(u)}else if(l===on.BIN){const u=Ge+r;this.body=e.slice(u,u+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Vs{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=M.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},l={},u={};for(const h in r){const c=Et[h]||h.toLowerCase();a[c]=r[h]}for(const h in e.attributes){const c=Et[h]||h.toLowerCase();if(r[h]!==void 0){const d=i.accessors[e.attributes[h]],p=ze[d.componentType];u[c]=p.name,l[c]=d.normalized===!0}}return t.getDependency("bufferView",o).then(function(h){return new Promise(function(c,d){s.decodeDracoFile(h,function(p){for(const m in p.attributes){const y=p.attributes[m],b=l[m];b!==void 0&&(y.normalized=b)}c(p)},a,u,de,d)})})}}class Ks{constructor(){this.name=M.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Xs{constructor(){this.name=M.KHR_MESH_QUANTIZATION}}class Fn extends Pi{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let r=0;r!==s;r++)t[r]=i[o+r];return t}interpolate_(e,t,i,s){const o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,h=s-t,c=(i-t)/h,d=c*c,p=d*c,m=e*u,y=m-u,b=-2*p+3*d,v=p-d,w=1-b,A=v-d+c;for(let _=0;_!==a;_++){const S=r[y+_+a],F=r[y+_+l]*h,D=r[m+_+a],x=r[m+_]*h;o[_]=w*S+A*F+b*D+v*x}return o}}const Ys=new lt;class Ws extends Fn{interpolate_(e,t,i,s){const o=super.interpolate_(e,t,i,s);return Ys.fromArray(o).normalize().toArray(o),o}}const oe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ze={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rn={9728:Pn,9729:et,9984:vi,9985:wi,9986:xi,9987:Rn},an={33071:Ti,33648:Ai,10497:xt},_t={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Et={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ve={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Qs={CUBICSPLINE:void 0,LINEAR:kn,STEP:Ei},gt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function $s(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new K({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Si})),n.DefaultMaterial}function Me(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function _e(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function qs(n,e,t){let i=!1,s=!1,o=!1;for(let u=0,h=e.length;u<h;u++){const c=e[u];if(c.POSITION!==void 0&&(i=!0),c.NORMAL!==void 0&&(s=!0),c.COLOR_0!==void 0&&(o=!0),i&&s&&o)break}if(!i&&!s&&!o)return Promise.resolve(n);const r=[],a=[],l=[];for(let u=0,h=e.length;u<h;u++){const c=e[u];if(i){const d=c.POSITION!==void 0?t.getDependency("accessor",c.POSITION):n.attributes.position;r.push(d)}if(s){const d=c.NORMAL!==void 0?t.getDependency("accessor",c.NORMAL):n.attributes.normal;a.push(d)}if(o){const d=c.COLOR_0!==void 0?t.getDependency("accessor",c.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l)]).then(function(u){const h=u[0],c=u[1],d=u[2];return i&&(n.morphAttributes.position=h),s&&(n.morphAttributes.normal=c),o&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}function Zs(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,s=t.length;i<s;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Js(n){let e;const t=n.extensions&&n.extensions[M.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+yt(t.attributes):e=n.indices+":"+yt(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,s=n.targets.length;i<s;i++)e+=":"+yt(n.targets[i]);return e}function yt(n){let e="";const t=Object.keys(n).sort();for(let i=0,s=t.length;i<s;i++)e+=t[i]+":"+n[t[i]]+";";return e}function St(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function eo(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":n.search(/\.ktx2($|\?)/i)>0||n.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const to=new He;class no{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new As,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=-1,o=!1,r=-1;if(typeof navigator<"u"){const a=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);s=i&&l?parseInt(l[1],10):-1,o=a.indexOf("Firefox")>-1,r=o?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&s<17||o&&r<98?this.textureLoader=new ri(this.options.manager):this.textureLoader=new ai(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Sn(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){const a={scene:r[0][s.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:s.asset,parser:i,userData:{}};return Me(o,a,s),_e(a,s),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let s=0,o=t.length;s<o;s++){const r=t[s].joints;for(let a=0,l=r.length;a<l;a++)e[r[a]].isBone=!0}for(let s=0,o=e.length;s<o;s++){const r=e[s];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const s=i.clone(),o=(r,a)=>{const l=this.associations.get(r);l!=null&&this.associations.set(a,l);for(const[u,h]of r.children.entries())o(h,a.children[u])};return o(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const s=e(t[i]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let s=0;s<t.length;s++){const o=e(t[s]);o&&i.push(o)}return i}getDependency(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(o,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[M.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(o,r){i.load($e.resolveURL(t.uri,s.path),o,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteLength||0,o=t.byteOffset||0;return i.slice(o,o+s)})}loadAccessor(e){const t=this,i=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const r=_t[s.type],a=ze[s.componentType],l=s.normalized===!0,u=new a(s.count*r);return Promise.resolve(new Re(u,r,l))}const o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(r){const a=r[0],l=_t[s.type],u=ze[s.componentType],h=u.BYTES_PER_ELEMENT,c=h*l,d=s.byteOffset||0,p=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,m=s.normalized===!0;let y,b;if(p&&p!==c){const v=Math.floor(d/p),w="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+v+":"+s.count;let A=t.cache.get(w);A||(y=new u(a,v*p,s.count*p/h),A=new li(y,p/h),t.cache.add(w,A)),b=new Mi(A,l,d%p/h,m)}else a===null?y=new u(s.count*l):y=new u(a,d,s.count*l),b=new Re(y,l,m);if(s.sparse!==void 0){const v=_t.SCALAR,w=ze[s.sparse.indices.componentType],A=s.sparse.indices.byteOffset||0,_=s.sparse.values.byteOffset||0,S=new w(r[1],A,s.sparse.count*v),F=new u(r[2],_,s.sparse.count*l);a!==null&&(b=new Re(b.array.slice(),b.itemSize,b.normalized)),b.normalized=!1;for(let D=0,x=S.length;D<x;D++){const E=S[D];if(b.setX(E,F[D*l]),l>=2&&b.setY(E,F[D*l+1]),l>=3&&b.setZ(E,F[D*l+2]),l>=4&&b.setW(E,F[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}b.normalized=m}return b})}loadTexture(e){const t=this.json,i=this.options,o=t.textures[e].source,r=t.images[o];let a=this.textureLoader;if(r.uri){const l=i.manager.getHandler(r.uri);l!==null&&(a=l)}return this.loadTextureImage(e,o,a)}loadTextureImage(e,t,i){const s=this,o=this.json,r=o.textures[e],a=o.images[t],l=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=r.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(o.samplers||{})[r.sampler]||{};return h.magFilter=rn[d.magFilter]||et,h.minFilter=rn[d.minFilter]||Rn,h.wrapS=an[d.wrapS]||xt,h.wrapT=an[d.wrapT]||xt,h.generateMipmaps=!h.isCompressedTexture&&h.minFilter!==Pn&&h.minFilter!==et,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const i=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(c=>c.clone());const r=s.images[e],a=self.URL||self.webkitURL;let l=r.uri||"",u=!1;if(r.bufferView!==void 0)l=i.getDependency("bufferView",r.bufferView).then(function(c){u=!0;const d=new Blob([c],{type:r.mimeType});return l=a.createObjectURL(d),l});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(c){return new Promise(function(d,p){let m=d;t.isImageBitmapLoader===!0&&(m=function(y){const b=new Wt(y);b.needsUpdate=!0,d(b)}),t.load($e.resolveURL(c,o.path),m,void 0,p)})}).then(function(c){return u===!0&&a.revokeObjectURL(l),_e(c,r),c.userData.mimeType=r.mimeType||eo(r.uri),c}).catch(function(c){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),c});return this.sourceCache[e]=h,h}assignTexture(e,t,i,s){const o=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),o.extensions[M.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[M.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=o.associations.get(r);r=o.extensions[M.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),o.associations.set(r,l)}}return s!==void 0&&(r.colorSpace=s),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const s=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ci,dt.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ui,dt.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(s||o||r){let a="ClonedMaterial:"+i.uuid+":";s&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),o&&(l.vertexColors=!0),r&&(l.flatShading=!0),s&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return K}loadMaterial(e){const t=this,i=this.json,s=this.extensions,o=i.materials[e];let r;const a={},l=o.extensions||{},u=[];if(l[M.KHR_MATERIALS_UNLIT]){const c=s[M.KHR_MATERIALS_UNLIT];r=c.getMaterialType(),u.push(c.extendParams(a,o,t))}else{const c=o.pbrMetallicRoughness||{};if(a.color=new T(1,1,1),a.opacity=1,Array.isArray(c.baseColorFactor)){const d=c.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],de),a.opacity=d[3]}c.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",c.baseColorTexture,Fe)),a.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,a.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",c.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",c.metallicRoughnessTexture))),r=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}o.doubleSided===!0&&(a.side=Tt);const h=o.alphaMode||gt.OPAQUE;if(h===gt.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===gt.MASK&&(a.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&r!==Ye&&(u.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new B(1,1),o.normalTexture.scale!==void 0)){const c=o.normalTexture.scale;a.normalScale.set(c,c)}if(o.occlusionTexture!==void 0&&r!==Ye&&(u.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&r!==Ye){const c=o.emissiveFactor;a.emissive=new T().setRGB(c[0],c[1],c[2],de)}return o.emissiveTexture!==void 0&&r!==Ye&&u.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,Fe)),Promise.all(u).then(function(){const c=new r(a);return o.name&&(c.name=o.name),_e(c,o),t.associations.set(c,{materials:e}),o.extensions&&Me(s,c,o),c})}createUniqueName(e){const t=hi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,s=this.primitiveCache;function o(a){return i[M.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return ln(l,a,t)})}const r=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],h=Js(u),c=s[h];if(c)r.push(c.promise);else{let d;u.extensions&&u.extensions[M.KHR_DRACO_MESH_COMPRESSION]?d=o(u):d=ln(new Dt,u,t),s[h]={primitive:u,promise:d},r.push(d)}}return Promise.all(r)}loadMesh(e){const t=this,i=this.json,s=this.extensions,o=i.meshes[e],r=o.primitives,a=[];for(let l=0,u=r.length;l<u;l++){const h=r[l].material===void 0?$s(this.cache):this.getDependency("material",r[l].material);a.push(h)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),h=l[l.length-1],c=[];for(let p=0,m=h.length;p<m;p++){const y=h[p],b=r[p];let v;const w=u[p];if(b.mode===oe.TRIANGLES||b.mode===oe.TRIANGLE_STRIP||b.mode===oe.TRIANGLE_FAN||b.mode===void 0)v=o.isSkinnedMesh===!0?new di(y,w):new R(y,w),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),b.mode===oe.TRIANGLE_STRIP?v.geometry=sn(v.geometry,En):b.mode===oe.TRIANGLE_FAN&&(v.geometry=sn(v.geometry,wt));else if(b.mode===oe.LINES)v=new fi(y,w);else if(b.mode===oe.LINE_STRIP)v=new pi(y,w);else if(b.mode===oe.LINE_LOOP)v=new mi(y,w);else if(b.mode===oe.POINTS)v=new _i(y,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);Object.keys(v.geometry.morphAttributes).length>0&&Zs(v,o),v.name=t.createUniqueName(o.name||"mesh_"+e),_e(v,o),b.extensions&&Me(s,v,b),t.assignFinalMaterial(v),c.push(v)}for(let p=0,m=c.length;p<m;p++)t.associations.set(c[p],{meshes:e,primitives:p});if(c.length===1)return o.extensions&&Me(s,c[0],o),c[0];const d=new $;o.extensions&&Me(s,d,o),t.associations.set(d,{meshes:e});for(let p=0,m=c.length;p<m;p++)d.add(c[p]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new On(Tn.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(t=new An(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),_e(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let s=0,o=t.joints.length;s<o;s++)i.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){const o=s.pop(),r=s,a=[],l=[];for(let u=0,h=r.length;u<h;u++){const c=r[u];if(c){a.push(c);const d=new He;o!==null&&d.fromArray(o.array,u*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new gi(a,l)})}loadAnimation(e){const t=this.json,i=this,s=t.animations[e],o=s.name?s.name:"animation_"+e,r=[],a=[],l=[],u=[],h=[];for(let c=0,d=s.channels.length;c<d;c++){const p=s.channels[c],m=s.samplers[p.sampler],y=p.target,b=y.node,v=s.parameters!==void 0?s.parameters[m.input]:m.input,w=s.parameters!==void 0?s.parameters[m.output]:m.output;y.node!==void 0&&(r.push(this.getDependency("node",b)),a.push(this.getDependency("accessor",v)),l.push(this.getDependency("accessor",w)),u.push(m),h.push(y))}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(h)]).then(function(c){const d=c[0],p=c[1],m=c[2],y=c[3],b=c[4],v=[];for(let w=0,A=d.length;w<A;w++){const _=d[w],S=p[w],F=m[w],D=y[w],x=b[w];if(_===void 0)continue;_.updateMatrix&&_.updateMatrix();const E=i._createAnimationTracks(_,S,F,D,x);if(E)for(let P=0;P<E.length;P++)v.push(E[P])}return new yi(o,void 0,v)})}createNodeMesh(e){const t=this.json,i=this,s=t.nodes[e];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(o){const r=i._getNodeRef(i.meshCache,s.mesh,o);return s.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let l=0,u=s.weights.length;l<u;l++)a.morphTargetInfluences[l]=s.weights[l]}),r})}loadNode(e){const t=this.json,i=this,s=t.nodes[e],o=i._loadNodeShallow(e),r=[],a=s.children||[];for(let u=0,h=a.length;u<h;u++)r.push(i.getDependency("node",a[u]));const l=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([o,Promise.all(r),l]).then(function(u){const h=u[0],c=u[1],d=u[2];d!==null&&h.traverse(function(p){p.isSkinnedMesh&&p.bind(d,to)});for(let p=0,m=c.length;p<m;p++)h.add(c[p]);return h})}_loadNodeShallow(e){const t=this.json,i=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=t.nodes[e],r=o.name?s.createUniqueName(o.name):"",a=[],l=s._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),o.camera!==void 0&&a.push(s.getDependency("camera",o.camera).then(function(u){return s._getNodeRef(s.cameraCache,o.camera,u)})),s._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let h;if(o.isBone===!0?h=new bi:u.length>1?h=new $:u.length===1?h=u[0]:h=new Cn,h!==u[0])for(let c=0,d=u.length;c<d;c++)h.add(u[c]);if(o.name&&(h.userData.name=o.name,h.name=r),_e(h,o),o.extensions&&Me(i,h,o),o.matrix!==void 0){const c=new He;c.fromArray(o.matrix),h.applyMatrix4(c)}else o.translation!==void 0&&h.position.fromArray(o.translation),o.rotation!==void 0&&h.quaternion.fromArray(o.rotation),o.scale!==void 0&&h.scale.fromArray(o.scale);return s.associations.has(h)||s.associations.set(h,{}),s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],s=this,o=new $;i.name&&(o.name=s.createUniqueName(i.name)),_e(o,i),i.extensions&&Me(t,o,i);const r=i.nodes||[],a=[];for(let l=0,u=r.length;l<u;l++)a.push(s.getDependency("node",r[l]));return Promise.all(a).then(function(l){for(let h=0,c=l.length;h<c;h++)o.add(l[h]);const u=h=>{const c=new Map;for(const[d,p]of s.associations)(d instanceof dt||d instanceof Wt)&&c.set(d,p);return h.traverse(d=>{const p=s.associations.get(d);p!=null&&c.set(d,p)}),c};return s.associations=u(o),o})}_createAnimationTracks(e,t,i,s,o){const r=[],a=e.name?e.name:e.uuid,l=[];ve[o.path]===ve.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let u;switch(ve[o.path]){case ve.weights:u=$t;break;case ve.rotation:u=qt;break;case ve.position:case ve.scale:u=Qt;break;default:switch(i.itemSize){case 1:u=$t;break;case 2:case 3:default:u=Qt;break}break}const h=s.interpolation!==void 0?Qs[s.interpolation]:kn,c=this._getArrayFromAccessor(i);for(let d=0,p=l.length;d<p;d++){const m=new u(l[d]+"."+ve[o.path],t.array,c,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(m),r.push(m)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=St(t.constructor),s=new Float32Array(t.length);for(let o=0,r=t.length;o<r;o++)s[o]=t[o]*i;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const s=this instanceof qt?Ws:Fn;return new s(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function io(n,e,t){const i=e.attributes,s=new Ci;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(s.set(new j(l[0],l[1],l[2]),new j(u[0],u[1],u[2])),a.normalized){const h=St(ze[a.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const a=new j,l=new j;for(let u=0,h=o.length;u<h;u++){const c=o[u];if(c.POSITION!==void 0){const d=t.json.accessors[c.POSITION],p=d.min,m=d.max;if(p!==void 0&&m!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(m[2]))),d.normalized){const y=St(ze[d.componentType]);l.multiplyScalar(y)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(a)}n.boundingBox=s;const r=new Ri;s.getCenter(r.center),r.radius=s.min.distanceTo(s.max)/2,n.boundingSphere=r}function ln(n,e,t){const i=e.attributes,s=[];function o(r,a){return t.getDependency("accessor",r).then(function(l){n.setAttribute(a,l)})}for(const r in i){const a=Et[r]||r.toLowerCase();a in n.attributes||s.push(o(i[r],a))}if(e.indices!==void 0&&!n.index){const r=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});s.push(r)}return Yt.workingColorSpace!==de&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Yt.workingColorSpace}" not supported.`),_e(n,e),io(n,e,t),Promise.all(s).then(function(){return e.targets!==void 0?qs(n,e.targets,t):n})}class so extends Oi{constructor(e){super(e),this.type=ae}parse(e){const r=function(x,E){switch(x){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(E||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(E||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(E||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(E||""))}},h=`
`,c=function(x,E,P){E=E||1024;let G=x.pos,U=-1,C=0,N="",k=String.fromCharCode.apply(null,new Uint16Array(x.subarray(G,G+128)));for(;0>(U=k.indexOf(h))&&C<E&&G<x.byteLength;)N+=k,C+=k.length,G+=128,k+=String.fromCharCode.apply(null,new Uint16Array(x.subarray(G,G+128)));return-1<U?(x.pos+=C+U+1,N+k.slice(0,U)):!1},d=function(x){const E=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,G=/^\s*FORMAT=(\S+)\s*$/,U=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,C={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let N,k;for((x.pos>=x.byteLength||!(N=c(x)))&&r(1,"no header found"),(k=N.match(E))||r(3,"bad initial token"),C.valid|=1,C.programtype=k[1],C.string+=N+`
`;N=c(x),N!==!1;){if(C.string+=N+`
`,N.charAt(0)==="#"){C.comments+=N+`
`;continue}if((k=N.match(P))&&(C.gamma=parseFloat(k[1])),(k=N.match(z))&&(C.exposure=parseFloat(k[1])),(k=N.match(G))&&(C.valid|=2,C.format=k[1]),(k=N.match(U))&&(C.valid|=4,C.height=parseInt(k[1],10),C.width=parseInt(k[2],10)),C.valid&2&&C.valid&4)break}return C.valid&2||r(3,"missing format specifier"),C.valid&4||r(3,"missing image size specifier"),C},p=function(x,E,P){const z=E;if(z<8||z>32767||x[0]!==2||x[1]!==2||x[2]&128)return new Uint8Array(x);z!==(x[2]<<8|x[3])&&r(3,"wrong scanline width");const G=new Uint8Array(4*E*P);G.length||r(4,"unable to allocate buffer space");let U=0,C=0;const N=4*z,k=new Uint8Array(4),J=new Uint8Array(N);let ge=P;for(;ge>0&&C<x.byteLength;){C+4>x.byteLength&&r(1),k[0]=x[C++],k[1]=x[C++],k[2]=x[C++],k[3]=x[C++],(k[0]!=2||k[1]!=2||(k[2]<<8|k[3])!=z)&&r(3,"bad rgbe scanline format");let ye=0,ie;for(;ye<N&&C<x.byteLength;){ie=x[C++];const se=ie>128;if(se&&(ie-=128),(ie===0||ye+ie>N)&&r(3,"bad scanline data"),se){const V=x[C++];for(let me=0;me<ie;me++)J[ye++]=V}else J.set(x.subarray(C,C+ie),ye),ye+=ie,C+=ie}const je=z;for(let se=0;se<je;se++){let V=0;G[U]=J[se+V],V+=z,G[U+1]=J[se+V],V+=z,G[U+2]=J[se+V],V+=z,G[U+3]=J[se+V],U+=4}ge--}return G},m=function(x,E,P,z){const G=x[E+3],U=Math.pow(2,G-128)/255;P[z+0]=x[E+0]*U,P[z+1]=x[E+1]*U,P[z+2]=x[E+2]*U,P[z+3]=1},y=function(x,E,P,z){const G=x[E+3],U=Math.pow(2,G-128)/255;P[z+0]=it.toHalfFloat(Math.min(x[E+0]*U,65504)),P[z+1]=it.toHalfFloat(Math.min(x[E+1]*U,65504)),P[z+2]=it.toHalfFloat(Math.min(x[E+2]*U,65504)),P[z+3]=it.toHalfFloat(1)},b=new Uint8Array(e);b.pos=0;const v=d(b),w=v.width,A=v.height,_=p(b.subarray(b.pos),w,A);let S,F,D;switch(this.type){case ft:D=_.length/4;const x=new Float32Array(D*4);for(let P=0;P<D;P++)m(_,P*4,x,P*4);S=x,F=ft;break;case ae:D=_.length/4;const E=new Uint16Array(D*4);for(let P=0;P<D;P++)y(_,P*4,E,P*4);S=E,F=ae;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:w,height:A,data:S,header:v.string,gamma:v.gamma,exposure:v.exposure,type:F}}setDataType(e){return this.type=e,this}load(e,t,i,s){function o(r,a){switch(r.type){case ft:case ae:r.colorSpace=de,r.minFilter=et,r.magFilter=et,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,a)}return super.load(e,o,i,s)}}const Hn={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class Un extends nt{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Ce?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Ln.clone(e.uniforms),this.material=new Ce({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Bn(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class cn extends nt{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const s=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let r,a;this.inverse?(r=0,a=1):(r=1,a=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,r,4294967295),o.buffers.stencil.setClear(a),o.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class oo extends nt{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class ro{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const i=e.getSize(new B);this._width=i.width,this._height=i.height,t=new we(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ae}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Un(Hn),this.copyPass.material.blending=At,this.clock=new ki}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let s=0,o=this.passes.length;s<o;s++){const r=this.passes[s];if(r.enabled!==!1){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),r.needsSwap){if(i){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}cn!==void 0&&(r instanceof cn?i=!0:r instanceof oo&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new B);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class xe extends nt{constructor(e,t,i,s){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=s!==void 0?s:[],this.visibleEdgeColor=new T(1,1,1),this.hiddenEdgeColor=new T(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this._selectionCache=new Set,this.resolution=e!==void 0?new B(e.x,e.y):new B(256,256);const o=Math.round(this.resolution.x/this.downSampleRatio),r=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new we(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new Li,this.depthMaterial.side=Tt,this.depthMaterial.depthPacking=Di,this.depthMaterial.blending=At,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=Tt,this.prepareMaskMaterial.fragmentShader=h(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new we(this.resolution.x,this.resolution.y,{type:ae}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new we(o,r,{type:ae}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new we(o,r,{type:ae}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new we(Math.round(o/2),Math.round(r/2),{type:ae}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new we(o,r,{type:ae}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new we(Math.round(o/2),Math.round(r/2),{type:ae}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;const a=4,l=4;this.separableBlurMaterial1=this.getSeparableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(o,r),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeparableBlurMaterial(l),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(o/2),Math.round(r/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=l,this.overlayMaterial=this.getOverlayMaterial();const u=Hn;this.copyUniforms=Ln.clone(u.uniforms),this.materialCopy=new Ce({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:At,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new T,this.oldClearAlpha=1,this.fsQuad=new Bn(null),this.tempPulseColor1=new T,this.tempPulseColor2=new T,this.textureMatrix=new He;function h(c,d){const p=d.isPerspectiveCamera?"perspective":"orthographic";return c.replace(/DEPTH_TO_VIEW_Z/g,p+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),s=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,s),this.renderTargetBlurBuffer1.setSize(i,s),this.renderTargetEdgeBuffer1.setSize(i,s),this.separableBlurMaterial1.uniforms.texSize.value.set(i,s),i=Math.round(i/2),s=Math.round(s/2),this.renderTargetBlurBuffer2.setSize(i,s),this.renderTargetEdgeBuffer2.setSize(i,s),this.separableBlurMaterial2.uniforms.texSize.value.set(i,s)}updateSelectionCache(){const e=this._selectionCache;function t(i){i.isMesh&&e.add(i)}e.clear();for(let i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(t)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;for(const i of this._selectionCache)e===!0?i.visible=t.get(i):(t.set(i,i.visible),i.visible=e)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=this._selectionCache;function s(o){if(o.isMesh||o.isSprite){if(!i.has(o)){const r=o.visible;(e===!1||t.get(o)===!0)&&(o.visible=e),t.set(o,r)}}else(o.isPoints||o.isLine)&&(e===!0?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))}this.renderScene.traverse(s)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,s,o){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const r=e.autoClear;e.autoClear=!1,o&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.updateSelectionCache(),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this._selectionCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=xe.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=xe.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=xe.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=xe.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,o&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=r}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Ce({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new B(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>

					vPosition = mvPosition;

					vec4 worldPosition = vec4( transformed, 1.0 );

					#ifdef USE_INSTANCING

						worldPosition = instanceMatrix * worldPosition;

					#endif

					worldPosition = modelMatrix * worldPosition;

					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new Ce({uniforms:{maskTexture:{value:null},texSize:{value:new B(.5,.5)},visibleEdgeColor:{value:new j(1,1,1)},hiddenEdgeColor:{value:new j(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeparableBlurMaterial(e){return new Ce({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new B(.5,.5)},direction:{value:new B(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new Ce({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:Ii,depthTest:!1,depthWrite:!1,transparent:!0})}}xe.BlurDirectionX=new B(1,0);xe.BlurDirectionY=new B(0,1);class ao extends nt{constructor(e,t,i=null,s=null,o=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new T}render(e,t,i){const s=e.autoClear;e.autoClear=!1;let o,r;this.overrideMaterial!==null&&(r=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=r),e.autoClear=s}}const lo={name:"GammaCorrectionShader",uniforms:{tDiffuse:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 tex = texture2D( tDiffuse, vUv );

			gl_FragColor = sRGBTransferOETF( tex );

		}`};class bt{constructor(e){this.top=0,this.array=new Float32Array(e)}write(e){this.array[this.top++]=e.x,this.array[this.top++]=e.y,this.array[this.top++]=e.z}}class co{constructor(e){this.top=0,this.array=new Float32Array(e)}write(e){this.array[this.top++]=e.x,this.array[this.top++]=e.y}}class he{constructor(e){this.plane=null,this.front=null,this.back=null,this.polygons=[],e&&this.build(e)}clone(){const e=new he;return e.plane=this.plane&&this.plane.clone(),e.front=this.front&&this.front.clone(),e.back=this.back&&this.back.clone(),e.polygons=this.polygons.map(t=>t.clone()),e}invert(){for(let t=0;t<this.polygons.length;t++)this.polygons[t].flip();this.plane&&this.plane.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const e=this.front;this.front=this.back,this.back=e}clipPolygons(e){if(!this.plane)return e.slice();let t=new Array,i=new Array;for(let s=0;s<e.length;s++)this.plane.splitPolygon(e[s],t,i,t,i);return this.front&&(t=this.front.clipPolygons(t)),this.back?i=this.back.clipPolygons(i):i=[],t.concat(i)}clipTo(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)}allPolygons(){let e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),this.back&&(e=e.concat(this.back.allPolygons())),e}build(e){if(!e.length)return;this.plane||(this.plane=e[0].plane.clone());const t=[],i=[];for(let s=0;s<e.length;s++)this.plane.splitPolygon(e[s],this.polygons,this.polygons,t,i);t.length&&(this.front||(this.front=new he),this.front.build(t)),i.length&&(this.back||(this.back=new he),this.back.build(i))}}class ne{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clone(){return new ne(this.x,this.y,this.z)}negate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}times(e){return this.x*=e,this.y*=e,this.z*=e,this}dividedBy(e){return this.x/=e,this.y/=e,this.z/=e,this}lerp(e,t){return this.add(new ne().copy(e).sub(this).times(t))}unit(){return this.dividedBy(this.length())}length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}normalize(){return this.unit()}cross(e){const t=this.clone(),i=t.x,s=t.y,o=t.z,r=e.x,a=e.y,l=e.z;return this.x=s*l-o*a,this.y=o*r-i*l,this.z=i*a-s*r,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}toVector3(){return new j(this.x,this.y,this.z)}}class Pe{constructor(e,t){this.normal=e,this.w=t,this.normal=e,this.w=t}clone(){return new Pe(this.normal.clone(),this.w)}flip(){this.normal.negate(),this.w=-this.w}splitPolygon(e,t,i,s,o){let h=0;const c=[];for(let d=0;d<e.vertices.length;d++){const p=this.normal.dot(e.vertices[d].pos)-this.w,m=p<-Pe.EPSILON?2:p>Pe.EPSILON?1:0;h|=m,c.push(m)}switch(h){case 0:(this.normal.dot(e.plane.normal)>0?t:i).push(e);break;case 1:s.push(e);break;case 2:o.push(e);break;case 3:{const d=[],p=[];for(let m=0;m<e.vertices.length;m++){const y=(m+1)%e.vertices.length,b=c[m],v=c[y],w=e.vertices[m],A=e.vertices[y];if(b!=2&&d.push(w),b!=1&&p.push(b!=2?w.clone():w),(b|v)==3){const _=(this.w-this.normal.dot(w.pos))/this.normal.dot(new ne().copy(A.pos).sub(w.pos)),S=w.interpolate(A,_);d.push(S),p.push(S.clone())}}d.length>=3&&s.push(new Ue(d,e.shared)),p.length>=3&&o.push(new Ue(p,e.shared));break}}}static fromPoints(e,t,i){const s=new ne().copy(t).sub(e).cross(new ne().copy(i).sub(e)).normalize();return new Pe(s.clone(),s.dot(e))}}Pe.EPSILON=1e-5;class Ue{constructor(e,t){this.vertices=e,this.shared=t,this.plane=Pe.fromPoints(e[0].pos,e[1].pos,e[2].pos)}clone(){return new Ue(this.vertices.map(e=>e.clone()),this.shared)}flip(){this.vertices.reverse().map(e=>e.flip()),this.plane.flip()}}class ct{constructor(e,t,i,s){this.pos=new ne().copy(e),this.normal=new ne().copy(t),this.uv=new ne().copy(i),this.uv.z=0,s&&(this.color=new ne().copy(s))}clone(){return new ct(this.pos,this.normal,this.uv,this.color)}flip(){this.normal.negate()}interpolate(e,t){return new ct(this.pos.clone().lerp(e.pos,t),this.normal.clone().lerp(e.normal,t),this.uv.clone().lerp(e.uv,t),this.color&&e.color&&this.color.clone().lerp(e.color,t))}}class H{constructor(){this.polygons=[]}static fromPolygons(e){const t=new H;return t.polygons=e,t}static fromGeometry(e,t){let i=[];const s=e.attributes.position,o=e.attributes.normal,r=e.attributes.uv,a=e.attributes.color,l=e.groups;let u;if(e.index)u=e.index.array;else{u=new Uint16Array(s.array.length/s.itemSize|0);for(let c=0;c<u.length;c++)u[c]=c}const h=u.length/3|0;i=new Array(h);for(let c=0,d=0,p=u.length;c<p;c+=3,d++){const m=new Array(3);for(let y=0;y<3;y++){const b=u[c+y],v=b*3,w=b*2,A=s.array[v],_=s.array[v+1],S=s.array[v+2],F=o.array[v],D=o.array[v+1],x=o.array[v+2],E=r==null?void 0:r.array[w],P=r==null?void 0:r.array[w+1];m[y]=new ct(new ne(A,_,S),new ne(F,D,x),new ne(E,P,0),a&&new ne(a.array[v],a.array[v+1],a.array[v+2]))}if(t===void 0&&l&&l.length>0)for(const y of l)c>=y.start&&c<y.start+y.count&&(i[d]=new Ue(m,y.materialIndex));else i[d]=new Ue(m,t)}return H.fromPolygons(i.filter(c=>!Number.isNaN(c.plane.normal.x)))}static toGeometry(e,t){let i=0;const s=e.polygons;for(const p of s)i+=p.vertices.length-2;const o=new Dt,r=new bt(i*3*3),a=new bt(i*3*3),l=new co(i*2*3);let u;const h=[],c=[];for(const p of s){const m=p.vertices,y=m.length;p.shared!==void 0&&(h[p.shared]||(h[p.shared]=[])),y&&m[0].color!==void 0&&(u||(u=new bt(i*3*3)));for(let b=3;b<=y;b++)(p.shared===void 0?c:h[p.shared]).push(r.top/3,r.top/3+1,r.top/3+2),r.write(m[0].pos),r.write(m[b-2].pos),r.write(m[b-1].pos),a.write(m[0].normal),a.write(m[b-2].normal),a.write(m[b-1].normal),l&&(l.write(m[0].uv),l.write(m[b-2].uv),l.write(m[b-1].uv)),u&&(u.write(m[0].color),u.write(m[b-2].color),u.write(m[b-1].color))}o.setAttribute("position",new Re(r.array,3)),o.setAttribute("normal",new Re(a.array,3)),l&&o.setAttribute("uv",new Re(l.array,2)),u&&o.setAttribute("color",new Re(u.array,3));for(let p=0;p<h.length;p++)h[p]===void 0&&(h[p]=[]);if(h.length){let p=[],m=0;for(let y=0;y<h.length;y++)o.addGroup(m,h[y].length,y),m+=h[y].length,p=p.concat(h[y]);o.addGroup(m,c.length,h.length),p=p.concat(c),o.setIndex(p)}const d=new He().copy(t).invert();return o.applyMatrix4(d),o.computeBoundingSphere(),o.computeBoundingBox(),o}static fromMesh(e,t){const i=H.fromGeometry(e.geometry,t),s=new j,o=new Ni;o.getNormalMatrix(e.matrix);for(let r=0;r<i.polygons.length;r++){const a=i.polygons[r];for(let l=0;l<a.vertices.length;l++){const u=a.vertices[l];u.pos.copy(s.copy(u.pos.toVector3()).applyMatrix4(e.matrix)),u.normal.copy(s.copy(u.normal.toVector3()).applyMatrix3(o))}}return i}static toMesh(e,t,i){const s=H.toGeometry(e,t),o=new R(s,i);return o.matrix.copy(t),o.matrix.decompose(o.position,o.quaternion,o.scale),o.rotation.setFromQuaternion(o.quaternion),o.updateMatrixWorld(),o.castShadow=o.receiveShadow=!0,o}static union(e,t){const i=H.fromMesh(e),s=H.fromMesh(t);return H.toMesh(i.union(s),e.matrix,e.material)}static subtract(e,t){const i=H.fromMesh(e),s=H.fromMesh(t);return H.toMesh(i.subtract(s),e.matrix,e.material)}static intersect(e,t){const i=H.fromMesh(e),s=H.fromMesh(t);return H.toMesh(i.intersect(s),e.matrix,e.material)}clone(){const e=new H;return e.polygons=this.polygons.map(t=>t.clone()).filter(t=>Number.isFinite(t.plane.w)),e}toPolygons(){return this.polygons}union(e){const t=new he(this.clone().polygons),i=new he(e.clone().polygons);return t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),H.fromPolygons(t.allPolygons())}subtract(e){const t=new he(this.clone().polygons),i=new he(e.clone().polygons);return t.invert(),t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),t.invert(),H.fromPolygons(t.allPolygons())}intersect(e){const t=new he(this.clone().polygons),i=new he(e.clone().polygons);return t.invert(),i.clipTo(t),i.invert(),t.clipTo(i),i.clipTo(t),t.build(i.allPolygons()),t.invert(),H.fromPolygons(t.allPolygons())}inverse(){const e=this.clone();for(const t of e.polygons)t.flip();return e}toMesh(e,t){return H.toMesh(this,e,t)}toGeometry(e){return H.toGeometry(this,e)}}function uo(n){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function Ie(n,e){var t=n.__state.conversionName.toString(),i=Math.round(n.r),s=Math.round(n.g),o=Math.round(n.b),r=n.a,a=Math.round(n.h),l=n.s.toFixed(1),u=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var h=n.hex.toString(16);h.length<6;)h="0"+h;return"#"+h}else{if(t==="CSS_RGB")return"rgb("+i+","+s+","+o+")";if(t==="CSS_RGBA")return"rgba("+i+","+s+","+o+","+r+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+i+","+s+","+o+"]";if(t==="RGBA_ARRAY")return"["+i+","+s+","+o+","+r+"]";if(t==="RGB_OBJ")return"{r:"+i+",g:"+s+",b:"+o+"}";if(t==="RGBA_OBJ")return"{r:"+i+",g:"+s+",b:"+o+",a:"+r+"}";if(t==="HSV_OBJ")return"{h:"+a+",s:"+l+",v:"+u+"}";if(t==="HSVA_OBJ")return"{h:"+a+",s:"+l+",v:"+u+",a:"+r+"}"}return"unknown format"}var un=Array.prototype.forEach,Ve=Array.prototype.slice,g={BREAK:{},extend:function(e){return this.each(Ve.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach((function(s){this.isUndefined(t[s])||(e[s]=t[s])}).bind(this))},this),e},defaults:function(e){return this.each(Ve.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach((function(s){this.isUndefined(e[s])&&(e[s]=t[s])}).bind(this))},this),e},compose:function(){var e=Ve.call(arguments);return function(){for(var t=Ve.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e){if(un&&e.forEach&&e.forEach===un)e.forEach(t,i);else if(e.length===e.length+0){var s=void 0,o=void 0;for(s=0,o=e.length;s<o;s++)if(s in e&&t.call(i,e[s],s)===this.BREAK)return}else for(var r in e)if(t.call(i,e[r],r)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var s=void 0;return function(){var o=this,r=arguments;function a(){s=null,i||e.apply(o,r)}var l=i||!s;clearTimeout(s),s=setTimeout(a,t),l&&e.apply(o,r)}},toArray:function(e){return e.toArray?e.toArray():Ve.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},ho=[{litmus:g.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Ie},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Ie},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Ie},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Ie}}},{litmus:g.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:g.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:g.isObject,conversions:{RGBA_OBJ:{read:function(e){return g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b)&&g.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return g.isNumber(e.r)&&g.isNumber(e.g)&&g.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v)&&g.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return g.isNumber(e.h)&&g.isNumber(e.s)&&g.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],Ke=void 0,rt=void 0,Mt=function(){rt=!1;var e=arguments.length>1?g.toArray(arguments):arguments[0];return g.each(ho,function(t){if(t.litmus(e))return g.each(t.conversions,function(i,s){if(Ke=i.read(e),rt===!1&&Ke!==!1)return rt=Ke,Ke.conversionName=s,Ke.conversion=i,g.BREAK}),g.BREAK}),rt},hn=void 0,ut={hsv_to_rgb:function(e,t,i){var s=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),r=i*(1-t),a=i*(1-o*t),l=i*(1-(1-o)*t),u=[[i,l,r],[a,i,r],[r,i,l],[r,a,i],[l,r,i],[i,r,a]][s];return{r:u[0]*255,g:u[1]*255,b:u[2]*255}},rgb_to_hsv:function(e,t,i){var s=Math.min(e,t,i),o=Math.max(e,t,i),r=o-s,a=void 0,l=void 0;if(o!==0)l=r/o;else return{h:NaN,s:0,v:0};return e===o?a=(t-i)/r:t===o?a=2+(i-e)/r:a=4+(e-t)/r,a/=6,a<0&&(a+=1),{h:a*360,s:l,v:o/255}},rgb_to_hex:function(e,t,i){var s=this.hex_with_component(0,2,e);return s=this.hex_with_component(s,1,t),s=this.hex_with_component(s,0,i),s},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,i){return i<<(hn=t*8)|e&~(255<<hn)}},fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},le=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},ce=function(){function n(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),Te=function n(e,t,i){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:n(o,t,i)}else{if("value"in s)return s.value;var r=s.get;return r===void 0?void 0:r.call(i)}},Ee=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},Se=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},q=function(){function n(){if(le(this,n),this.__state=Mt.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return ce(n,[{key:"toString",value:function(){return Ie(this)}},{key:"toHexString",value:function(){return Ie(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function Bt(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(q.recalculateRGB(this,e,t),this.__state[e])},set:function(s){this.__state.space!=="RGB"&&(q.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=s}})}function zt(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(q.recalculateHSV(this),this.__state[e])},set:function(i){this.__state.space!=="HSV"&&(q.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}q.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=ut.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")g.extend(n.__state,ut.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};q.recalculateHSV=function(n){var e=ut.rgb_to_hsv(n.r,n.g,n.b);g.extend(n.__state,{s:e.s,v:e.v}),g.isNaN(e.h)?g.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};q.COMPONENTS=["r","g","b","h","s","v","hex","a"];Bt(q.prototype,"r",2);Bt(q.prototype,"g",1);Bt(q.prototype,"b",0);zt(q.prototype,"h");zt(q.prototype,"s");zt(q.prototype,"v");Object.defineProperty(q.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(q.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=ut.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Oe=function(){function n(e,t){le(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return ce(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),po={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},jn={};g.each(po,function(n,e){g.each(n,function(t){jn[t]=e})});var mo=/(\d+(\.\d+)?)px/;function ue(n){if(n==="0"||g.isUndefined(n))return 0;var e=n.match(mo);return g.isNull(e)?0:parseFloat(e[1])}var f={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var s=i,o=t;g.isUndefined(o)&&(o=!0),g.isUndefined(s)&&(s=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),s&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,s){var o=i||{},r=jn[t];if(!r)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":{var l=o.x||o.clientX||0,u=o.y||o.clientY||0;a.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var h=a.initKeyboardEvent||a.initKeyEvent;g.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),h(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{a.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}}g.defaults(a,s),e.dispatchEvent(a)},bind:function(e,t,i,s){var o=s||!1;return e.addEventListener?e.addEventListener(t,i,o):e.attachEvent&&e.attachEvent("on"+t,i),f},unbind:function(e,t,i,s){var o=s||!1;return e.removeEventListener?e.removeEventListener(t,i,o):e.detachEvent&&e.detachEvent("on"+t,i),f},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);i.indexOf(t)===-1&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return f},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),s=i.indexOf(t);s!==-1&&(i.splice(s,1),e.className=i.join(" "))}else e.className=void 0;return f},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return ue(t["border-left-width"])+ue(t["border-right-width"])+ue(t["padding-left"])+ue(t["padding-right"])+ue(t.width)},getHeight:function(e){var t=getComputedStyle(e);return ue(t["border-top-width"])+ue(t["border-bottom-width"])+ue(t["padding-top"])+ue(t["padding-bottom"])+ue(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent;while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Gn=function(n){Ee(e,n);function e(t,i){le(this,e);var s=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=s;s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox");function r(){o.setValue(!o.__prev)}return f.bind(s.__checkbox,"change",r,!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return ce(e,[{key:"setValue",value:function(i){var s=Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),s}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Oe),_o=function(n){Ee(e,n);function e(t,i,s){le(this,e);var o=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=s,a=o;if(o.__select=document.createElement("select"),g.isArray(r)){var l={};g.each(r,function(u){l[u]=u}),r=l}return g.each(r,function(u,h){var c=document.createElement("option");c.innerHTML=h,c.setAttribute("value",u),a.__select.appendChild(c)}),o.updateDisplay(),f.bind(o.__select,"change",function(){var u=this.options[this.selectedIndex].value;a.setValue(u)}),o.domElement.appendChild(o.__select),o}return ce(e,[{key:"setValue",value:function(i){var s=Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),s}},{key:"updateDisplay",value:function(){return f.isActive(this.__select)?this:(this.__select.value=this.getValue(),Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Oe),go=function(n){Ee(e,n);function e(t,i){le(this,e);var s=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=s;function r(){o.setValue(o.__input.value)}function a(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),f.bind(s.__input,"keyup",r),f.bind(s.__input,"change",r),f.bind(s.__input,"blur",a),f.bind(s.__input,"keydown",function(l){l.keyCode===13&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return ce(e,[{key:"updateDisplay",value:function(){return f.isActive(this.__input)||(this.__input.value=this.getValue()),Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Oe);function dn(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var Vn=function(n){Ee(e,n);function e(t,i,s){le(this,e);var o=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=s||{};return o.__min=r.min,o.__max=r.max,o.__step=r.step,g.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=dn(o.__impliedStep),o}return ce(e,[{key:"setValue",value:function(i){var s=i;return this.__min!==void 0&&s<this.__min?s=this.__min:this.__max!==void 0&&s>this.__max&&(s=this.__max),this.__step!==void 0&&s%this.__step!==0&&(s=Math.round(s/this.__step)*this.__step),Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,s)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=dn(i),this}}]),e}(Oe);function yo(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var ht=function(n){Ee(e,n);function e(t,i,s){le(this,e);var o=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s));o.__truncationSuspended=!1;var r=o,a=void 0;function l(){var m=parseFloat(r.__input.value);g.isNaN(m)||r.setValue(m)}function u(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function h(){u()}function c(m){var y=a-m.clientY;r.setValue(r.getValue()+y*r.__impliedStep),a=m.clientY}function d(){f.unbind(window,"mousemove",c),f.unbind(window,"mouseup",d),u()}function p(m){f.bind(window,"mousemove",c),f.bind(window,"mouseup",d),a=m.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),f.bind(o.__input,"change",l),f.bind(o.__input,"blur",h),f.bind(o.__input,"mousedown",p),f.bind(o.__input,"keydown",function(m){m.keyCode===13&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,u())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return ce(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():yo(this.getValue(),this.__precision),Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Vn);function fn(n,e,t,i,s){return i+(s-i)*((n-e)/(t-e))}var Ct=function(n){Ee(e,n);function e(t,i,s,o,r){le(this,e);var a=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:s,max:o,step:r})),l=a;a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),f.bind(a.__background,"mousedown",u),f.bind(a.__background,"touchstart",d),f.addClass(a.__background,"slider"),f.addClass(a.__foreground,"slider-fg");function u(y){document.activeElement.blur(),f.bind(window,"mousemove",h),f.bind(window,"mouseup",c),h(y)}function h(y){y.preventDefault();var b=l.__background.getBoundingClientRect();return l.setValue(fn(y.clientX,b.left,b.right,l.__min,l.__max)),!1}function c(){f.unbind(window,"mousemove",h),f.unbind(window,"mouseup",c),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function d(y){y.touches.length===1&&(f.bind(window,"touchmove",p),f.bind(window,"touchend",m),p(y))}function p(y){var b=y.touches[0].clientX,v=l.__background.getBoundingClientRect();l.setValue(fn(b,v.left,v.right,l.__min,l.__max))}function m(){f.unbind(window,"touchmove",p),f.unbind(window,"touchend",m),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return ce(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=i*100+"%",Te(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Vn),Kn=function(n){Ee(e,n);function e(t,i,s){le(this,e);var o=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),r=o;return o.__button=document.createElement("div"),o.__button.innerHTML=s===void 0?"Fire":s,f.bind(o.__button,"click",function(a){return a.preventDefault(),r.fire(),!1}),f.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return ce(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Oe),Rt=function(n){Ee(e,n);function e(t,i){le(this,e);var s=Se(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));s.__color=new q(s.getValue()),s.__temp=new q(0);var o=s;s.domElement=document.createElement("div"),f.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",f.bind(s.__input,"keydown",function(y){y.keyCode===13&&c.call(this)}),f.bind(s.__input,"blur",c),f.bind(s.__selector,"mousedown",function(){f.addClass(this,"drag").bind(window,"mouseup",function(){f.removeClass(o.__selector,"drag")})}),f.bind(s.__selector,"touchstart",function(){f.addClass(this,"drag").bind(window,"touchend",function(){f.removeClass(o.__selector,"drag")})});var r=document.createElement("div");g.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),g.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),g.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),g.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),g.extend(r.style,{width:"100%",height:"100%",background:"none"}),pn(r,"top","rgba(0,0,0,0)","#000"),g.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),vo(s.__hue_field),g.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),f.bind(s.__saturation_field,"mousedown",a),f.bind(s.__saturation_field,"touchstart",a),f.bind(s.__field_knob,"mousedown",a),f.bind(s.__field_knob,"touchstart",a),f.bind(s.__hue_field,"mousedown",l),f.bind(s.__hue_field,"touchstart",l);function a(y){p(y),f.bind(window,"mousemove",p),f.bind(window,"touchmove",p),f.bind(window,"mouseup",u),f.bind(window,"touchend",u)}function l(y){m(y),f.bind(window,"mousemove",m),f.bind(window,"touchmove",m),f.bind(window,"mouseup",h),f.bind(window,"touchend",h)}function u(){f.unbind(window,"mousemove",p),f.unbind(window,"touchmove",p),f.unbind(window,"mouseup",u),f.unbind(window,"touchend",u),d()}function h(){f.unbind(window,"mousemove",m),f.unbind(window,"touchmove",m),f.unbind(window,"mouseup",h),f.unbind(window,"touchend",h),d()}function c(){var y=Mt(this.value);y!==!1?(o.__color.__state=y,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function d(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}s.__saturation_field.appendChild(r),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay();function p(y){y.type.indexOf("touch")===-1&&y.preventDefault();var b=o.__saturation_field.getBoundingClientRect(),v=y.touches&&y.touches[0]||y,w=v.clientX,A=v.clientY,_=(w-b.left)/(b.right-b.left),S=1-(A-b.top)/(b.bottom-b.top);return S>1?S=1:S<0&&(S=0),_>1?_=1:_<0&&(_=0),o.__color.v=S,o.__color.s=_,o.setValue(o.__color.toOriginal()),!1}function m(y){y.type.indexOf("touch")===-1&&y.preventDefault();var b=o.__hue_field.getBoundingClientRect(),v=y.touches&&y.touches[0]||y,w=v.clientY,A=1-(w-b.top)/(b.bottom-b.top);return A>1?A=1:A<0&&(A=0),o.__color.h=A*360,o.setValue(o.__color.toOriginal()),!1}return s}return ce(e,[{key:"updateDisplay",value:function(){var i=Mt(this.getValue());if(i!==!1){var s=!1;g.each(q.COMPONENTS,function(a){if(!g.isUndefined(i[a])&&!g.isUndefined(this.__color.__state[a])&&i[a]!==this.__color.__state[a])return s=!0,{}},this),s&&g.extend(this.__color.__state,i)}g.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,r=255-o;g.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,pn(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),g.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}(Oe),bo=["-moz-","-o-","-webkit-","-ms-",""];function pn(n,e,t,i){n.style.background="",g.each(bo,function(s){n.style.cssText+="background: "+s+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}function vo(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var wo={load:function(e,t){var i=t||document,s=i.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,i.getElementsByTagName("head")[0].appendChild(s)},inject:function(e,t){var i=t||document,s=document.createElement("style");s.type="text/css",s.innerHTML=e;var o=i.getElementsByTagName("head")[0];try{o.appendChild(s)}catch{}}},xo=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,To=function(e,t){var i=e[t];return g.isArray(arguments[2])||g.isObject(arguments[2])?new _o(e,t,arguments[2]):g.isNumber(i)?g.isNumber(arguments[2])&&g.isNumber(arguments[3])?g.isNumber(arguments[4])?new Ct(e,t,arguments[2],arguments[3],arguments[4]):new Ct(e,t,arguments[2],arguments[3]):g.isNumber(arguments[4])?new ht(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ht(e,t,{min:arguments[2],max:arguments[3]}):g.isString(i)?new go(e,t):g.isFunction(i)?new Kn(e,t,""):g.isBoolean(i)?new Gn(e,t):null};function Ao(n){setTimeout(n,1e3/60)}var Eo=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Ao,So=function(){function n(){le(this,n),this.backgroundElement=document.createElement("div"),g.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),f.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),g.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;f.bind(this.backgroundElement,"click",function(){e.hide()})}return ce(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),g.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function s(){t.domElement.style.display="none",t.backgroundElement.style.display="none",f.unbind(t.domElement,"webkitTransitionEnd",s),f.unbind(t.domElement,"transitionend",s),f.unbind(t.domElement,"oTransitionEnd",s)};f.bind(this.domElement,"webkitTransitionEnd",i),f.bind(this.domElement,"transitionend",i),f.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-f.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-f.getHeight(this.domElement)/2+"px"}}]),n}(),Mo=uo(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);wo.inject(Mo);var mn="dg",_n=72,gn=20,tt="Default",We=function(){try{return!!window.localStorage}catch{return!1}}(),qe=void 0,yn=!0,ke=void 0,vt=!1,Xn=[],I=function n(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),f.addClass(this.domElement,mn),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=g.defaults(i,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),i=g.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),g.isUndefined(i.load)?i.load={preset:tt}:i.preset&&(i.load.preset=i.preset),g.isUndefined(i.parent)&&i.hideable&&Xn.push(this),i.resizable=g.isUndefined(i.parent)&&i.resizable,i.autoPlace&&g.isUndefined(i.scrollable)&&(i.scrollable=!0);var s=We&&localStorage.getItem(Le(this,"isLocal"))==="true",o=void 0,r=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(d){t.parent?t.getRoot().preset=d:i.load.preset=d,Oo(this),t.revert()}},width:{get:function(){return i.width},set:function(d){i.width=d,kt(t,d)}},name:{get:function(){return i.name},set:function(d){i.name=d,r&&(r.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(d){i.closed=d,i.closed?f.addClass(t.__ul,n.CLASS_CLOSED):f.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=d?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return s},set:function(d){We&&(s=d,d?f.bind(window,"unload",o):f.unbind(window,"unload",o),localStorage.setItem(Le(t,"isLocal"),d))}}}),g.isUndefined(i.parent)){if(this.closed=i.closed||!1,f.addClass(this.domElement,n.CLASS_MAIN),f.makeSelectable(this.domElement,!1),We&&s){t.useLocalStorage=!0;var a=localStorage.getItem(Le(this,"gui"));a&&(i.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,f.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),i.closeOnTop?(f.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(f.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),f.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{i.closed===void 0&&(i.closed=!0);var l=document.createTextNode(i.name);f.addClass(l,"controller-name"),r=Ft(t,l);var u=function(d){return d.preventDefault(),t.closed=!t.closed,!1};f.addClass(this.__ul,n.CLASS_CLOSED),f.addClass(r,"title"),f.bind(r,"click",u),i.closed||(this.closed=!1)}i.autoPlace&&(g.isUndefined(i.parent)&&(yn&&(ke=document.createElement("div"),f.addClass(ke,mn),f.addClass(ke,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ke),yn=!1),ke.appendChild(this.domElement),f.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||kt(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},f.bind(window,"resize",this.__resizeHandler),f.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),f.bind(this.__ul,"transitionend",this.__resizeHandler),f.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&Po(this),o=function(){We&&localStorage.getItem(Le(t,"isLocal"))==="true"&&localStorage.setItem(Le(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function h(){var c=t.getRoot();c.width+=1,g.defer(function(){c.width-=1})}i.parent||h()};I.toggleHide=function(){vt=!vt,g.each(Xn,function(n){n.domElement.style.display=vt?"none":""})};I.CLASS_AUTO_PLACE="a";I.CLASS_AUTO_PLACE_CONTAINER="ac";I.CLASS_MAIN="main";I.CLASS_CONTROLLER_ROW="cr";I.CLASS_TOO_TALL="taller-than-window";I.CLASS_CLOSED="closed";I.CLASS_CLOSE_BUTTON="close-button";I.CLASS_CLOSE_TOP="close-top";I.CLASS_CLOSE_BOTTOM="close-bottom";I.CLASS_DRAG="drag";I.DEFAULT_WIDTH=245;I.TEXT_CLOSED="Close Controls";I.TEXT_OPEN="Open Controls";I._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===_n||n.keyCode===_n)&&I.toggleHide()};f.bind(window,"keydown",I._keydownHandler,!1);g.extend(I.prototype,{add:function(e,t){return Ze(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Ze(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;g.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ke.removeChild(this.domElement);var e=this;g.each(this.__folders,function(t){e.removeFolder(t)}),f.unbind(window,"keydown",I._keydownHandler,!1),bn(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new I(t);this.__folders[e]=i;var s=Ft(this,i.domElement);return f.addClass(s,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],bn(e);var t=this;g.each(e.__folders,function(i){e.removeFolder(i)}),g.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=f.getOffset(e.__ul).top,i=0;g.each(e.__ul.childNodes,function(s){e.autoPlace&&s===e.__save_row||(i+=f.getHeight(s))}),window.innerHeight-t-gn<i?(f.addClass(e.domElement,I.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-gn+"px"):(f.removeClass(e.domElement,I.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&g.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:g.debounce(function(){this.onResize()},50),remember:function(){if(g.isUndefined(qe)&&(qe=new So,qe.domElement.innerHTML=xo),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;g.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&Ro(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&kt(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=at(this)),e.folders={},g.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=at(this),Pt(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[tt]=at(this,!0)),this.load.remembered[e]=at(this),this.preset=e,Ot(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){g.each(this.__controllers,function(t){this.getRoot().load.remembered?Yn(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),g.each(this.__folders,function(t){t.revert(t)}),e||Pt(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&Wn(this.__listening)},updateDisplay:function(){g.each(this.__controllers,function(e){e.updateDisplay()}),g.each(this.__folders,function(e){e.updateDisplay()})}});function Ft(n,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?n.__ul.insertBefore(i,t):n.__ul.appendChild(i),n.onResize(),i}function bn(n){f.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&f.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function Pt(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function Co(n,e,t){if(t.__li=e,t.__gui=n,g.extend(t,{options:function(r){if(arguments.length>1){var a=t.__li.nextElementSibling;return t.remove(),Ze(n,t.object,t.property,{before:a,factoryArgs:[g.toArray(arguments)]})}if(g.isArray(r)||g.isObject(r)){var l=t.__li.nextElementSibling;return t.remove(),Ze(n,t.object,t.property,{before:l,factoryArgs:[r]})}},name:function(r){return t.__li.firstElementChild.firstElementChild.innerHTML=r,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof Ct){var i=new ht(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});g.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var r=t[o],a=i[o];t[o]=i[o]=function(){var l=Array.prototype.slice.call(arguments);return a.apply(i,l),r.apply(t,l)}}),f.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof ht){var s=function(r){if(g.isNumber(t.__min)&&g.isNumber(t.__max)){var a=t.__li.firstElementChild.firstElementChild.innerHTML,l=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=Ze(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(a),l&&u.listen(),u}return r};t.min=g.compose(s,t.min),t.max=g.compose(s,t.max)}else t instanceof Gn?(f.bind(e,"click",function(){f.fakeEvent(t.__checkbox,"click")}),f.bind(t.__checkbox,"click",function(o){o.stopPropagation()})):t instanceof Kn?(f.bind(e,"click",function(){f.fakeEvent(t.__button,"click")}),f.bind(e,"mouseover",function(){f.addClass(t.__button,"hover")}),f.bind(e,"mouseout",function(){f.removeClass(t.__button,"hover")})):t instanceof Rt&&(f.addClass(e,"color"),t.updateDisplay=g.compose(function(o){return e.style.borderLeftColor=t.__color.toString(),o},t.updateDisplay),t.updateDisplay());t.setValue=g.compose(function(o){return n.getRoot().__preset_select&&t.isModified()&&Pt(n.getRoot(),!0),o},t.setValue)}function Yn(n,e){var t=n.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(i!==-1){var s=t.__rememberedObjectIndecesToControllers[i];if(s===void 0&&(s={},t.__rememberedObjectIndecesToControllers[i]=s),s[e.property]=e,t.load&&t.load.remembered){var o=t.load.remembered,r=void 0;if(o[n.preset])r=o[n.preset];else if(o[tt])r=o[tt];else return;if(r[i]&&r[i][e.property]!==void 0){var a=r[i][e.property];e.initialValue=a,e.setValue(a)}}}}function Ze(n,e,t,i){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var s=void 0;if(i.color)s=new Rt(e,t);else{var o=[e,t].concat(i.factoryArgs);s=To.apply(n,o)}i.before instanceof Oe&&(i.before=i.before.__li),Yn(n,s),f.addClass(s.domElement,"c");var r=document.createElement("span");f.addClass(r,"property-name"),r.innerHTML=s.property;var a=document.createElement("div");a.appendChild(r),a.appendChild(s.domElement);var l=Ft(n,a,i.before);return f.addClass(l,I.CLASS_CONTROLLER_ROW),s instanceof Rt?f.addClass(l,"color"):f.addClass(l,fo(s.getValue())),Co(n,l,s),n.__controllers.push(s),s}function Le(n,e){return document.location.href+"."+e}function Ot(n,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,n.__preset_select.appendChild(i),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function vn(n,e){e.style.display=n.useLocalStorage?"block":"none"}function Ro(n){var e=n.__save_row=document.createElement("li");f.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),f.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",f.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",f.addClass(i,"button"),f.addClass(i,"save");var s=document.createElement("span");s.innerHTML="New",f.addClass(s,"button"),f.addClass(s,"save-as");var o=document.createElement("span");o.innerHTML="Revert",f.addClass(o,"button"),f.addClass(o,"revert");var r=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?g.each(n.load.remembered,function(c,d){Ot(n,d,d===n.preset)}):Ot(n,tt,!1),f.bind(r,"change",function(){for(var c=0;c<n.__preset_select.length;c++)n.__preset_select[c].innerHTML=n.__preset_select[c].value;n.preset=this.value}),e.appendChild(r),e.appendChild(t),e.appendChild(i),e.appendChild(s),e.appendChild(o),We){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),u=document.getElementById("dg-save-locally");u.style.display="block",localStorage.getItem(Le(n,"isLocal"))==="true"&&l.setAttribute("checked","checked"),vn(n,a),f.bind(l,"change",function(){n.useLocalStorage=!n.useLocalStorage,vn(n,a)})}var h=document.getElementById("dg-new-constructor");f.bind(h,"keydown",function(c){c.metaKey&&(c.which===67||c.keyCode===67)&&qe.hide()}),f.bind(t,"click",function(){h.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),qe.show(),h.focus(),h.select()}),f.bind(i,"click",function(){n.save()}),f.bind(s,"click",function(){var c=prompt("Enter a new preset name.");c&&n.saveAs(c)}),f.bind(o,"click",function(){n.revert()})}function Po(n){var e=void 0;n.__resize_handle=document.createElement("div"),g.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(o){return o.preventDefault(),n.width+=e-o.clientX,n.onResize(),e=o.clientX,!1}function i(){f.removeClass(n.__closeButton,I.CLASS_DRAG),f.unbind(window,"mousemove",t),f.unbind(window,"mouseup",i)}function s(o){return o.preventDefault(),e=o.clientX,f.addClass(n.__closeButton,I.CLASS_DRAG),f.bind(window,"mousemove",t),f.bind(window,"mouseup",i),!1}f.bind(n.__resize_handle,"mousedown",s),f.bind(n.__closeButton,"mousedown",s),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function kt(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function at(n,e){var t={};return g.each(n.__rememberedObjects,function(i,s){var o={},r=n.__rememberedObjectIndecesToControllers[s];g.each(r,function(a,l){o[l]=e?a.initialValue:a.getValue()}),t[s]=o}),t}function Oo(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function Wn(n){n.length!==0&&Eo.call(window,function(){Wn(n)}),g.each(n,function(e){e.updateDisplay()})}var ko=I;const Y="/",Z=new Ts,Lo=()=>{const n=new $,e=new te(400,400,10),t=new K({color:16776952,roughness:.4,metalness:0}),i=new R(e,t);i.rotation.x=-Math.PI/2,i.position.y=0;const s=new te(400,400,3),o=new K({color:15589060,roughness:.4,metalness:0}),r=new R(s,o);return r.rotation.x=-Math.PI/2,r.position.y=5,n.add(r),n.add(i),n},Ae=(n,e,t,i)=>{const s=new $,o=new te(n,e,t),r=new K({color:i[1],roughness:.4,metalness:0}),a=new R(o,r);a.position.y=e/2;const l=a.clone();l.position.z=t,l.material=new K({color:i[0],roughness:.4,metalness:0});const u=a.clone();return u.position.z=-1,u.material=new K({color:i[2],roughness:.4,metalness:0}),s.add(l),s.add(a),s.add(u),l.receiveShadow=!0,a.receiveShadow=!0,u.receiveShadow=!0,s.name="wallGroup&unmoveable",s},Ht=(n,e,t)=>{const i=new $,s=new R(new te(n-10,e-20,t),new K({color:16777215,roughness:.4,metalness:0})),o=new R(new te(n,e,t),new K({color:15653556,roughness:.4,metalness:0}));s.position.z=-1,s.updateMatrix(),o.updateMatrix();const r=H.subtract(o,s),a=new R(new te(n-10,e-10,t),new K({color:16777215,roughness:.4,metalness:0}));return a.position.z=-.5,a.receiveShadow=!0,r.receiveShadow=!0,i.add(a),i.add(r),i.name="doorGroup",i},Ut=(n,e,t,i)=>{const s=new $,o=new R(new te(n,e,t),new K({color:i[0],roughness:.4,metalness:0})),r=o.clone();r.scale.set(.9,.9,.9),r.material=new K({color:i[1],roughness:.4,metalness:0}),r.position.z=-.5;const a=r.clone();return a.scale.set(.7,.7,.7),a.material=new K({color:i[2],roughness:.4,metalness:0}),a.position.z=-.8,a.receiveShadow=!0,r.receiveShadow=!0,o.receiveShadow=!0,s.add(a),s.add(r),s.add(o),s.name="frameGroup",s},Do=(n,e,t)=>{const i=new $,s=new R(new te(n,e,t),new K({color:15417944,roughness:.4,metalness:0})),o=new R(new te(n-20,e/2,t*.8),s.material);o.position.set(0,e/4,-50*.2),s.updateMatrix(),o.updateMatrix();const r=H.subtract(s,o);return r.updateMatrix(),r.name="sofa",r.receiveShadow=!0,i.add(r),i.name="sofaGroup",i},Qn=()=>{const n=new $,e=new R(new Bi(15,15,2,32),new K({color:11184810,roughness:.93,metalness:0})),t=new R(new zi(15,1,16,100),new K({color:14137239,roughness:.93,metalness:0}));e.position.set(0,15,0),t.rotation.x=Math.PI/2,t.position.set(0,-15,0);const i=t.clone();i.rotation.set(Math.PI/2,Math.PI/2,0),i.position.set(-14,0,0);const s=i.clone();s.position.set(14,0,0);const o=t.clone();o.position.set(0,0,14),o.rotation.set(0,Math.PI,0);const r=o.clone();return r.position.set(0,0,-14),t.receiveShadow=!0,i.receiveShadow=!0,s.receiveShadow=!0,o.receiveShadow=!0,r.receiveShadow=!0,n.add(e,t,i,s,o,r),n.name="circleChairGroup",n},Io=()=>{const n=new $,e=Ae(200,200,1,[new T(15972710),new T(16313558),new T(16776952)]);e.position.z=-200-.5,e.position.x=100,e.position.y=-5;const t=e.clone();t.position.z=0,t.rotation.y=Math.PI;const i=Ae(200,200,1,[new T(16776952),new T(16313558),new T(16776952)]);i.position.x=200,i.position.z=-100,i.position.y=-5,i.rotation.y=-Math.PI/2;const s=i.clone();s.position.x=0,n.add(e),n.add(i),n.add(t),n.add(s);const o=Ht(60,150,2);o.position.set(60,75,-2),o.name="hallDoor",O.push({uuid:o.uuid,position:o.position,rotation:o.rotation,children:o.children}),n.add(o);const r=Ut(60,70,2,[new T(4937837),new T(15525320),new T(8748925)]);r.position.set(150,115,-2),n.add(r),Z.load(Y+"models/flowerpot.glb",A=>{A.scene.position.set(120,10,-20);const _=A.scene;_.name="flowerpot";const S=_.clone();S.position.set(100,10,-20),O.push({uuid:_.uuid,position:{x:_.position.x,y:_.position.y,z:_.position.z},rotation:{x:_.rotation.x,y:_.rotation.y,z:_.rotation.z},children:_.children}),O.push({uuid:S.uuid,position:{x:S.position.x,y:_.position.y,z:S.position.z},rotation:{x:S.rotation.x,y:_.rotation.y,z:_.rotation.z},children:S.children}),n.add(_,S)}),Z.load(Y+"models/desk.glb",A=>{const _=A.scene;_.scale.set(2,2,2),_.position.set(165,20,-90),_.name="desk",_.receiveShadow=!0,O.push({uuid:_.uuid,position:{x:_.position.x,y:_.position.y,z:_.position.z},rotation:{x:_.rotation.x,y:_.rotation.y,z:_.rotation.z},children:_.children}),n.add(_)}),Z.load(Y+"models/fruitPlatter.glb",A=>{const _=A.scene;_.position.set(150,60,-80),_.name="fruitPlatter",O.push({uuid:_.uuid,position:{x:_.position.x,y:_.position.y,z:_.position.z},rotation:{x:_.rotation.x,y:_.rotation.y,z:_.rotation.z},children:_.children}),n.add(_)}),Z.load(Y+"models/cups.glb",A=>{const _=A.scene;_.position.set(160,60,-90),_.name="cups",O.push({uuid:_.uuid,position:{x:_.position.x,y:_.position.y,z:_.position.z},rotation:{x:_.rotation.x,y:_.rotation.y,z:_.rotation.z},children:_.children}),n.add(_)});const a=Qn();a.position.set(20,30,-160),O.push({uuid:a.uuid,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},children:a.children}),n.add(a);const l=new $,u=new R(new te(120,20,30),new K({color:12292466,roughness:.93,metalness:0})),h=new R(new te(110,10,20),new K({color:12292466,roughness:.93,metalness:0}));u.position.set(0,0,-10),u.updateMatrix(),h.updateMatrix();const c=H.subtract(u,h);c.position.set(100,20,-150),l.add(c);const d=new R(new te(5,25,5),new K({color:12292466,roughness:.93,metalness:0}));d.position.set(45,0,-140);const p=d.clone();p.position.set(155,0,-140),l.position.set(10,25,-10),l.add(d,p),l.name="televisionTable",O.push({uuid:l.uuid,position:{x:l.position.x,y:l.position.y,z:l.position.z},rotation:{x:l.rotation.x,y:l.rotation.y,z:l.rotation.z},children:l.children}),n.add(l),Z.load(Y+"models/television.glb",A=>{const _=A.scene;_.scale.set(1.5,1.5,1.5),_.position.set(80,40,-180),_.rotation.y=Math.PI/2,_.name="television",O.push({uuid:_.uuid,position:{x:_.position.x,y:_.position.y,z:_.position.z},rotation:{x:_.rotation.x,y:_.rotation.y,z:_.rotation.z},children:_.children}),n.add(_)});const m=new $,y=new R(new te(70,70,15),new K({color:14201989,roughness:.4,metalness:0}));y.position.z=5;const b=new R(new te(60,10,15),new K({color:14201989,roughness:.4,metalness:0}));b.position.set(0,10,7);const v=b.clone();v.position.set(0,-10,7),m.add(y,b,v),m.rotation.y=Math.PI/2,m.position.set(5,35,-100),m.name="cabinet",O.push({uuid:m.uuid,position:{x:m.position.x,y:m.position.y,z:m.position.z},rotation:{x:m.rotation.x,y:m.rotation.y,z:m.rotation.z},children:m.children}),n.add(m);const w=Do(90,50,50);return w.position.set(80,40,-100),O.push({uuid:w.uuid,position:{x:w.position.x,y:w.position.y,z:w.position.z},rotation:{x:w.rotation.x,y:w.rotation.y,z:w.rotation.z},children:w.children}),n.add(w),n.name="hallGroup",n},No=()=>{const n=new $,e=Ae(200,200,1,[new T(12117210),new T(16313558),new T(16776952)]);e.rotation.y=-Math.PI/2,e.position.set(-1,-5,-100),n.add(e);const t=e.clone();t.position.set(-200,-5,-100),t.rotation.y=Math.PI/2,n.add(t);const i=Ae(200,200,1,[new T(9357168),new T(16313558),new T(16776952)]);i.position.set(-100,-5,0),i.rotation.y=Math.PI,n.add(i);const s=i.clone();return s.position.set(-100,-5,-200),s.rotation.y=Math.PI,n.add(s),Z.load(Y+"models/kitchenTool1.glb",o=>{const r=o.scene;r.traverse(a=>{a instanceof R&&(a.receiveShadow=!0)}),r.scale.set(1.5,1.5,1.5),r.rotation.y=Math.PI/2,r.position.set(-45,-5,-70),r.name="kitchenTool1",O.push({uuid:r.uuid,position:{x:r.position.x,y:r.position.y,z:r.position.z},rotation:{x:r.rotation.x,y:r.rotation.y,z:r.rotation.z},children:r.children}),n.add(r)}),Z.load(Y+"models/kitchenTool2.glb",o=>{const r=o.scene;r.traverse(a=>{a instanceof R&&(a.receiveShadow=!0)}),r.scale.set(1.2,1.2,1.2),r.rotation.y=Math.PI/2,r.position.set(-130,10,-110),r.name="kitchenTool2",O.push({uuid:r.uuid,position:{x:r.position.x,y:r.position.y,z:r.position.z},rotation:{x:r.rotation.x,y:r.rotation.y,z:r.rotation.z},children:r.children}),n.add(r)}),Z.load(Y+"models/exhaustFan.glb",o=>{const r=o.scene;r.traverse(a=>{a instanceof R&&(a.receiveShadow=!0)}),r.scale.set(1.2,1.2,1.2),r.rotation.y=Math.PI/2,r.position.set(-166,80,-120),r.name="exhaustFan",O.push({uuid:r.uuid,position:{x:r.position.x,y:r.position.y,z:r.position.z},rotation:{x:r.rotation.x,y:r.rotation.y,z:r.rotation.z},children:r.children}),n.add(r)}),Z.load(Y+"models/fridge.glb",o=>{const r=o.scene;r.scale.set(1.2,1.2,1.2),r.rotation.y=Math.PI/2,r.position.set(-205,5,-50),r.name="fridge",O.push({uuid:r.uuid,position:{x:r.position.x,y:r.position.y,z:r.position.z},rotation:{x:r.rotation.x,y:r.rotation.y,z:r.rotation.z},children:r.children}),n.add(r)}),n},Bo=()=>{const n=new $,e=Ae(300,200,1,[new T(16313558),new T(16313558),new T(16776952)]);e.position.set(-50,-5,1),n.add(e);const t=e.clone();t.position.set(-50,-5,200),t.rotation.y=Math.PI,n.add(t);const i=Ae(200,200,1,[new T(15972710),new T(16313558),new T(16776952)]);i.position.set(100,-5,100),i.rotation.y=-Math.PI/2,n.add(i);const s=i.clone();s.position.set(-200,-5,100),s.rotation.y=Math.PI/2,n.add(s),Z.load(Y+"models/bed.glb",h=>{const c=h.scene;c.traverse(d=>{d instanceof R&&(d.receiveShadow=!0)}),c.scale.set(1.8,1.8,1.8),c.rotation.y=Math.PI/2,c.position.set(-165,25,130),c.name="bed",O.push({uuid:c.uuid,position:{x:c.position.x,y:c.position.y,z:c.position.z},rotation:{x:c.rotation.x,y:c.rotation.y,z:c.rotation.z},children:c.children}),n.add(c)});const o=Qn();o.position.set(-180,25,20),O.push({uuid:o.uuid,position:{x:o.position.x,y:o.position.y,z:o.position.z},rotation:{x:o.rotation.x,y:o.rotation.y,z:o.rotation.z},children:o.children});const r=o.clone();r.position.set(-180,25,180),O.push({uuid:r.uuid,position:{x:r.position.x,y:r.position.y,z:r.position.z},rotation:{x:r.rotation.x,y:r.rotation.y,z:r.rotation.z},children:r.children}),n.add(o),n.add(r),Z.load(Y+"models/whiteChair.glb",h=>{const c=h.scene;c.traverse(p=>{p instanceof R&&(p.receiveShadow=!0)}),c.scale.set(1.5,1.5,1.5),c.rotation.y=Math.PI/2,c.position.set(45,20,90),c.name="whiteChair",O.push({uuid:c.uuid,position:{x:c.position.x,y:c.position.y,z:c.position.z},rotation:{x:c.rotation.x,y:c.rotation.y,z:c.rotation.z},children:c.children});const d=c.clone();d.position.set(40,20,150),d.rotation.y=-Math.PI/2,O.push({uuid:d.uuid,position:{x:d.position.x,y:d.position.y,z:d.position.z},rotation:{x:d.rotation.x,y:d.rotation.y,z:d.rotation.z},children:d.children}),n.add(c,d)}),Z.load(Y+"models/greenChair.glb",h=>{const c=h.scene;c.traverse(d=>{d instanceof R&&(d.receiveShadow=!0)}),c.scale.set(1.5,1.5,1.5),c.rotation.y=Math.PI/2,c.position.set(80,0,100),c.name="greenChair",O.push({uuid:c.uuid,position:{x:c.position.x,y:c.position.y,z:c.position.z},rotation:{x:c.rotation.x,y:c.rotation.y,z:c.rotation.z},children:c.children}),n.add(c)}),Z.load(Y+"models/fruitPlatter.glb",h=>{const c=h.scene;c.traverse(d=>{d instanceof R&&(d.receiveShadow=!0)}),c.rotation.y=Math.PI/2,c.position.set(30,20,140),c.name="fruitPlatter",O.push({uuid:c.uuid,position:{x:c.position.x,y:c.position.y,z:c.position.z},rotation:{x:c.rotation.x,y:c.rotation.y,z:c.rotation.z},children:c.children}),n.add(c)});const a=Ht(60,150,2);a.position.set(-50,80,2),a.rotation.y=Math.PI,O.push({uuid:a.uuid,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},children:a.children}),n.add(a);const l=a.clone();l.position.set(99,75,90),l.rotation.y=Math.PI/2,O.push({uuid:l.uuid,position:{x:l.position.x,y:l.position.y,z:l.position.z},rotation:{x:l.rotation.x,y:l.rotation.y,z:l.rotation.z},children:l.children}),n.add(l);const u=Ut(90,70,1,[new T(15653556),new T(16313558),new T(11184810)]);return u.position.set(-40,110,197),O.push({uuid:u.uuid,position:{x:u.position.x,y:u.position.y,z:u.position.z},rotation:{x:u.rotation.x,y:u.rotation.y,z:u.rotation.z},children:u.children}),n.add(u),n},zo=()=>{const n=new $,e=Ae(200,200,1,[new T(12829372),new T(16313558),new T(16776952)]);e.position.set(200,-5,100),e.rotation.y=-Math.PI/2,n.add(e);const t=e.clone();t.position.set(101,-5,100),t.rotation.y=Math.PI/2,n.add(t);const i=Ae(100,200,1,[new T(12829372),new T(16313558),new T(16776952)]);i.position.set(150,-5,200),i.rotation.y=-Math.PI,n.add(i),Z.load(Y+"models/sink.glb",r=>{const a=r.scene;a.traverse(l=>{l instanceof R&&(l.receiveShadow=!0)}),a.scale.set(1.5,1.5,1.5),a.rotation.y=Math.PI/2,a.position.set(205,-5,80),a.name="sink",O.push({uuid:a.uuid,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},children:a.children}),n.add(a)}),Z.load(Y+"models/toilet.glb",r=>{const a=r.scene;a.traverse(l=>{l instanceof R&&(l.receiveShadow=!0)}),a.scale.set(1.5,1.5,1.5),a.rotation.y=Math.PI/2,a.position.set(68,-15,20),a.name="toilet",O.push({uuid:a.uuid,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},children:a.children}),n.add(a)}),Z.load(Y+"models/garbage.glb",r=>{const a=r.scene;a.traverse(l=>{l instanceof R&&(l.receiveShadow=!0)}),a.scale.set(1.5,1.5,1.5),a.rotation.y=Math.PI/2,a.position.set(160,-5,0),a.name="garbage",O.push({uuid:a.uuid,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},children:a.children}),n.add(a)}),Z.load(Y+"models/bath.glb",r=>{const a=r.scene;a.traverse(l=>{l instanceof R&&(l.receiveShadow=!0)}),a.scale.set(1.5,1.5,1.5),a.rotation.y=Math.PI/2,a.position.set(170,20,150),a.name="bath&unmoveable",n.add(a)});const s=Ht(60,150,2);s.position.set(102,80,90),s.rotation.y=-Math.PI/2,O.push({uuid:s.uuid,position:{x:s.position.x,y:s.position.y,z:s.position.z},rotation:{x:s.rotation.x,y:s.rotation.y,z:s.rotation.z},children:s.children}),n.add(s);const o=Ut(50,60,1,[new T(15653556),new T(16313558),new T(11184810)]);return o.position.set(196,120,80),o.rotation.y=Math.PI/2,O.push({uuid:o.uuid,position:{x:o.position.x,y:o.position.y,z:o.position.z},rotation:{x:o.rotation.x,y:o.rotation.y,z:o.rotation.z},children:o.children}),n.add(o),n},O=[],X={rx:0,ry:0,rz:0,color:new T(11184810).getHex(),opacity:1};let re=[];const Fo=(n,e)=>{X.rx=n.rotation.x,X.ry=n.rotation.y,X.rz=n.rotation.z,X.color=new T(11184810).getHex(),X.opacity=1,re.push(e.add(X,"rx",-Math.PI/2,Math.PI/2).name("x").onChange(t=>{n.rotation.x=t})),re.push(e.add(X,"ry",-Math.PI/2,Math.PI/2).name("y").onChange(t=>{n.rotation.y=t})),re.push(e.add(X,"rz",-Math.PI/2,Math.PI/2).name("z").onChange(t=>{n.rotation.z=t})),re.push(e.addColor(X,"color").name("").onChange(t=>{n.traverse(i=>{i instanceof R&&i.material.color.set(t)})})),re.push(e.add(X,"opacity",0,1).name("").onChange(t=>{n.traverse(i=>{i instanceof R&&(i.material.opacity=t)})}))},Ho=(n,e)=>{if(!n.children.length)return;re.forEach(s=>{e.remove(s)}),re=[];let t=new T(11184810),i=1;n.traverse(s=>{if(s instanceof R){t=s.material.color,i=s.material.opacity;return}}),X.rx=n.rotation.x,X.ry=n.rotation.y,X.rz=n.rotation.z,X.color=t.getHex(),X.opacity=i,re.push(e.add(X,"rx",0,Math.PI*2).name("x").onChange(s=>{n.rotation.x=s})),re.push(e.add(X,"ry",0,Math.PI*2).name("y").onChange(s=>{n.rotation.y=s})),re.push(e.add(X,"rz",0,Math.PI*2).name("z").onChange(s=>{n.rotation.z=s})),re.push(e.addColor(X,"color").name("").onChange(s=>{n.traverse(o=>{o instanceof R&&o.material.color.set(s)})})),re.push(e.add(X,"opacity",0,1).name("").onChange(s=>{n.traverse(o=>{o instanceof R&&(o.material.transparent=!0,o.material.opacity=s)})})),n.isChanged=!0},Uo=(n,e)=>{let t=[];return n.traverse(i=>{i instanceof $&&!i.name.includes("unmoveable")&&t.push({uuid:i.uuid,position:{x:i.position.x,y:i.position.y,z:i.position.z},rotation:{x:i.rotation.x,y:i.rotation.y,z:i.rotation.z},children:i.children})}),e.setInitialGroupData(t),t},jo=n=>{O.forEach(t=>{const i=n.getObjectByProperty("uuid",t.uuid);i&&i.isChanged&&(i.position.set(t.position.x,t.position.y,t.position.z),i.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),i.isChanged=!1,t.children[0].isObject3D&&t.children.length>0&&t.children[0].isMesh&&(i.children=t.children))});const e=[];n.traverse(t=>{t.isNew&&e.push(t)}),e.forEach(t=>{n.remove(t)})},Go=(n,e)=>{if(e==="1"){const t=n.getObjectByName("sofaGroup").clone();console.log(t),t.position.set(5,30,45),t.isNew=!0,n.add(t)}if(e==="1"){const t=n.getObjectByName("cabinet").clone();t.position.set(-5,30,45),t.isNew=!0,n.add(t)}},wn=Dn("global",()=>{const n=It(!0);return{isLoading:n,setIsLoading:t=>{n.value=t}}}),Vo=Dn("initialGroupData",()=>{const n=It([]);function e(s){n.value=s}function t(s){n.value.push(s)}function i(){n.value=[]}return{initialGroupData:n,addInitialGroupData:t,clearInitialGroupData:i,setInitialGroupData:e}});var Je=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Je.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?Je.Bounce.In(n*2)*.5:Je.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),Qe=function(){return performance.now()},Ko=function(){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var s=0,o=t;s<o.length;s++){var r=o[s];(e=r._group)===null||e===void 0||e.remove(r),r._group=this,this._tweens[r.getId()]=r,this._tweensAddedDuringUpdate[r.getId()]=r}},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,s=e;i<s.length;i++){var o=s[i];o._group=void 0,delete this._tweens[o.getId()],delete this._tweensAddedDuringUpdate[o.getId()]}},n.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},n.prototype.update=function(e,t){e===void 0&&(e=Qe()),t===void 0&&(t=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var o=this._tweens[i[s]],r=!t;o&&o.update(e,r)===!1&&!t&&this.remove(o)}i=Object.keys(this._tweensAddedDuringUpdate)}},n}(),Ne={Linear:function(n,e){var t=n.length-1,i=t*e,s=Math.floor(i),o=Ne.Utils.Linear;return e<0?o(n[0],n[1],i):e>1?o(n[t],n[t-1],t-i):o(n[s],n[s+1>t?t:s+1],i-s)},Bezier:function(n,e){for(var t=0,i=n.length-1,s=Math.pow,o=Ne.Utils.Bernstein,r=0;r<=i;r++)t+=s(1-e,i-r)*s(e,r)*n[r]*o(i,r);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,s=Math.floor(i),o=Ne.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(s=Math.floor(i=t*(1+e))),o(n[(s-1+t)%t],n[s],n[(s+1)%t],n[(s+2)%t],i-s)):e<0?n[0]-(o(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(o(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):o(n[s?s-1:0],n[s],n[t<s+1?t:s+1],n[t<s+2?t:s+2],i-s)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Ne.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,s){var o=(t-n)*.5,r=(i-e)*.5,a=s*s,l=s*a;return(2*e-2*t+o+r)*l+(-3*e+3*t-2*o-r)*a+o*s+e}}},Xo=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),Lt=new Ko,Yo=function(){function n(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Je.Linear.None,this._interpolationFunction=Ne.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Xo.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=Lt,Lt.add(this))}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=Qe()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,s,o){for(var r in i){var a=e[r],l=Array.isArray(a),u=l?"array":typeof a,h=!l&&Array.isArray(i[r]);if(!(u==="undefined"||u==="function")){if(h){var c=i[r];if(c.length===0)continue;for(var d=[a],p=0,m=c.length;p<m;p+=1){var y=this._handleRelativeValue(a,c[p]);if(isNaN(y)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}d.push(y)}h&&(i[r]=d)}if((u==="object"||l)&&a&&!h){t[r]=l?[]:{};var b=a;for(var v in b)t[r][v]=b[v];s[r]=l?[]:{};var c=i[r];if(!this._isDynamic){var w={};for(var v in c)w[v]=c[v];i[r]=c=w}this._setupProperties(b,t[r],c,s[r],o)}else(typeof t[r]>"u"||o)&&(t[r]=a),l||(t[r]*=1),h?s[r]=i[r].slice().reverse():s[r]=t[r]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},n.prototype.pause=function(e){return e===void 0&&(e=Qe()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},n.prototype.resume=function(e){return e===void 0&&(e=Qe()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},n.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=Je.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Ne.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var i=this,s;if(e===void 0&&(e=Qe()),t===void 0&&(t=n.autoStartOnUpdate),this._isPaused)return!0;var o;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var r=e-this._startTime,a=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),l=this._duration+this._repeat*a,u=function(){if(i._duration===0||r>l)return 1;var y=Math.trunc(r/a),b=r-y*a,v=Math.min(b/i._duration,1);return v===0&&r===i._duration?1:v},h=u(),c=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||r>=this._duration)if(this._repeat>0){var d=Math.min(Math.trunc((r-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=d);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*d,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,m=this._chainedTweens.length;p<m;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,s){for(var o in i)if(t[o]!==void 0){var r=t[o]||0,a=i[o],l=Array.isArray(e[o]),u=Array.isArray(a),h=!l&&u;h?e[o]=this._interpolationFunction(a,s):typeof a=="object"&&a?this._updateProperties(e[o],r,a,s):(a=this._handleRelativeValue(r,a),typeof a=="number"&&(e[o]=r+(a-r)*s))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n.autoStartOnUpdate=!1,n}(),fe=Lt;fe.getAll.bind(fe);fe.removeAll.bind(fe);fe.add.bind(fe);fe.remove.bind(fe);fe.update.bind(fe);const Wo={class:"loading"},Qo={class:"side-bar-item-name"},$o={class:"side-bar-sub-item"},qo=["onClick"],Zo=["src"],Jo=Fi({__name:"Home",setup(n){let e,t,i,s,o,r,a=new $,l;const u=Hi("canvas"),h=wn(),c=Vo(),{isLoading:d}=Ui(wn()),p=[{name:"",subItems:[{name:"1",imgSrc:Y+"images/sofa1.png"}]},{name:"",subItems:[{name:"1",imgSrc:Y+"images/cabinet1.png"}]}];let m=It(!1);const y=()=>{i=new Xi({antialias:!0,alpha:!0,canvas:u.value}),i.setClearColor(0,1),i.setSize(window.innerWidth,window.innerHeight),i.setPixelRatio(window.devicePixelRatio),i.shadowMap.enabled=!0,i.outputColorSpace=Fe,i.toneMapping=Yi,i.toneMappingExposure=1,e=new Wi;const S=new so;S.setPath(Y+"textures/"),S.load("royal_esplanade_1k.hdr",function(V){V.mapping=Qi,e.background=V,e.environment=V,e.backgroundBlurriness=.35,e.environmentIntensity=.23}),t=new On(60,window.innerWidth/window.innerHeight,.1,1e3),t.position.set(0,500,500),t.lookAt(0,0,0),s=new as(t,i.domElement),s.update(),s.enableDamping=!0;const F=new Yo(t.position);F.to({x:0,y:400,z:0},2e3),o=new ro(i),o.addPass(new ao(e,t));const D=new Un(lo);o.addPass(D),r=new xe(new B(window.innerWidth/window.devicePixelRatio,window.innerHeight/window.devicePixelRatio),e,t),o.addPass(r);const x=new $i(16777215,.5);e.add(x);const E=new Mn(16777215,.5);E.position.set(0,300,50),E.castShadow=!0,e.add(E);const P=Lo();P.name="floor&unmoveable",e.add(P);const z=Io();e.add(z);const G=No();e.add(G);const U=Bo();e.add(U);const C=zo();e.add(C),qi.onProgress=function(V,me,be){me==be&&(console.log(V),h.setIsLoading(!1),F.start())};const N=new Zi;let k=!1,J=new B,ge,ye,ie,je;document.addEventListener("pointerdown",function(V){J.x=V.clientX/window.innerWidth*2-1,J.y=-(V.clientY/window.innerHeight)*2+1,N.setFromCamera(J,t);const me=N.intersectObjects(e.children,!0);if(me.length>0){let be=me[0].object;for(;!(be.parent instanceof $);)be=be.parent;if(a=be.parent,a&&!a.name.includes("unmoveable")){k=!0,s.enabled=!1;const Gt=[];a.traverse(Vt=>{Vt instanceof R&&Gt.push(Vt)}),ge=new xn,ge.setFromNormalAndCoplanarPoint(t.getWorldDirection(ge.normal),a.position),ie=new j,N.ray.intersectPlane(ge,ie),ye=a.position.clone(),r.selectedObjects=Gt,Ho(a,l)}}}),document.addEventListener("pointermove",function(V){if(!a||!k||a.name.includes("unmoveable"))return;J.x=V.clientX/window.innerWidth*2-1,J.y=-(V.clientY/window.innerHeight)*2+1,N.setFromCamera(J,t),a.position.x=J.x*500,a.position.y=J.y*500,je=new j,N.ray.intersectPlane(ge,je);let me=je.sub(ie),be=ye.clone().add(me).clone();a.position.copy(be)}),document.addEventListener("pointerup",function(){k=!1,s.enabled=!0,a=new $,r.selectedObjects=[]}),l=new ko,Fo(a,l),Uo(e,c);const se=()=>{requestAnimationFrame(se),F.update(),s.update(),o.render()};se(),window.addEventListener("resize",b)},b=()=>{t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight),o.setSize(window.innerWidth,window.innerHeight)},v=()=>{jo(e)},w=()=>{m.value=!0},A=()=>{m.value=!1},_=S=>{Go(e,S)};return ji(()=>{var S;y(),(S=document.getElementById("app"))==null||S.appendChild(l.domElement)}),(S,F)=>(Xe(),st(pt,null,[Gi(W("div",Wo,F[0]||(F[0]=[W("div",{class:"lds-roller"},[W("div"),W("div"),W("div"),W("div"),W("div"),W("div"),W("div"),W("div")],-1)]),512),[[Vi,Zt(d)]]),W("canvas",{id:"webgl",ref_key:"canvas",ref:u},null,512),W("div",{class:"reset",onClick:v},""),W("div",{class:Ki(["side-bar",{active:Zt(m)}]),onMouseenter:w,onMouseleave:A},[F[1]||(F[1]=W("div",{class:"pointer"},null,-1)),(Xe(),st(pt,null,Jt(p,D=>W("div",{class:"side-bar-item",key:D.name},[W("span",Qo,en(D.name),1),W("div",$o,[(Xe(!0),st(pt,null,Jt(D.subItems,x=>(Xe(),st("div",{key:x.name,class:"model-item",onClick:E=>_(x.name)},[W("img",{src:x.imgSrc,alt:""},null,8,Zo),W("span",null,""+en(x.name),1)],8,qo))),128))])])),64))],34)],64))}}),er=In(Jo,[["__scopeId","data-v-70025732"]]),tr=[{path:"/",name:"Home",component:er}],nr=Ji({history:es(),routes:tr}),jt=ts(os);jt.use(nr);const ir=ns();jt.use(ir);jt.mount("#app");
